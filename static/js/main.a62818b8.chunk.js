(this["webpackJsonpreact-diagram-demo"]=this["webpackJsonpreact-diagram-demo"]||[]).push([[0],{119:function(e,t,n){},120:function(e,t,n){},147:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),o=n.n(a),i=n(30),r=n.n(i),u=(n(147),n(11)),s=n(6),d=n(27),l={canvasRef:null,portRefs:{},nodeRefs:{},scale:1},f=Object(a.createContext)(l),b=f.Provider,j=function(){return Object(a.useContext)(f).scale},p=o.a.memo((function(e){var t=e.children,n=e.portRefs,o=e.nodeRefs,i=e.transform,r=i.scale,u=i.translateX,s=i.translateY,l=Object(a.useState)(null),f=Object(d.a)(l,2),j=f[0],p=f[1],O=Object(a.useRef)(null);Object(a.useEffect)((function(){p(O.current)}),[]);var v=Object(a.useMemo)((function(){return{canvasRef:j,portRefs:n,nodeRefs:o,scale:r}}),[j,n,o,r]);return Object(c.jsx)("div",{id:"diagram-canvas",className:"diagram-canvas",ref:O,style:{transform:"matrix(".concat(r,",0,0,").concat(r,",").concat(u,",").concat(s,")")},children:Object(c.jsx)(b,{value:v,children:t})})}));p.displayName="DiagramCanvas";var O=n(141),v=n(163),m=["INPUT","TEXTAREA"],h={ref:null,throttleBy:0},g=function(e){return[e.clientX,e.clientY]},y=function(e){return Object(a.useCallback)((function(t){e.current&&t===e.current||(e.current=t)}),[e])},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=e.ref,n=Object(a.useRef)(),c=Object(a.useRef)(),o=Object(a.useRef)(),i=Object(a.useRef)({isDragging:!1,start:[0,0],end:[0,0],offset:[0,0]}),r=i.current,u=Object(a.useCallback)((function(e){var c=e.target.tagName;r.isDragging||!(null===t||void 0===t?void 0:t.current.contains(e.target))||m.includes(c)||(r.isDragging=!0,r.end=[0,0],r.offset=[0,0],r.start=g(e),n.current&&n.current(e,Object(s.a)({},r)))}),[t,r,n]),d=Object(a.useCallback)(Object(v.a)((function(e){r.isDragging&&(r.offset=[e.clientX-r.start[0],e.clientY-r.start[1]],c.current&&c.current(e,Object(s.a)({},r)))}),e.throttleBy),[t,r,c]),l=Object(a.useCallback)((function(e){r.isDragging&&(r.isDragging=!1,r.end=g(e),o.current&&o.current(e,Object(s.a)({},r)))}),[r,o]);return Object(a.useEffect)((function(){var e=function(e){return u(e)},n=function(e){return d(e)},c=function(e){return l(e)};return(null===t||void 0===t?void 0:t.current)&&(t.current.addEventListener("mousedown",e),document.addEventListener("mousemove",n),document.addEventListener("mouseup",c)),function(){(null===t||void 0===t?void 0:t.current)&&(t.current.removeEventListener("mousedown",e),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",c))}}),[t,u,d,l]),{ref:t,onDragStart:y(n),onDrag:y(c),onDragEnd:y(o)}},x=n(33),k=n(159),C=(n(87),function(e){var t=e.icon,n=e.label;return Object(c.jsxs)("h4",{className:"node-header",children:[t&&Object(c.jsx)("div",{className:"node-header-icon",children:o.a.createElement(t)}),Object(c.jsx)("div",{className:"node-header-text",children:n})]})});C.displayName="NodeTypeHeader";var N=function(e){var t=e.value,n=e.onChange;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(C,{icon:V.nodeTypeInput.icon,label:V.nodeTypeInput.label}),Object(c.jsx)(k.a,{value:t.inputValue,onChange:function(e){n(Object(s.a)(Object(s.a)({},t),{},{inputValue:e.target.value}))},placeholder:"Basic usage"})]})};N.displayName="NodeTypeInput";var D=n(157),E=function(e){var t=e.value,n=e.onChange;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(C,{icon:V.nodeTypeSelect.icon,label:V.nodeTypeSelect.label}),Object(c.jsxs)(D.a,{style:{width:120},value:t.selectValue,onChange:function(e){n(Object(s.a)(Object(s.a)({},t),{},{selectValue:e}))},children:[Object(c.jsx)(D.a.Option,{value:"jack",children:"Jack"}),Object(c.jsx)(D.a.Option,{value:"lucy",children:"Lucy"}),Object(c.jsx)(D.a.Option,{value:"disabled",disabled:!0,children:"Disabled"}),Object(c.jsx)(D.a.Option,{value:"Yiminghe",children:"yiminghe"})]})]})};E.displayName="NodeTypeSelect";var T=n(138),S=function(e){var t=e.value;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(C,{icon:V.nodeTypeButton.icon,label:V.nodeTypeButton.label}),t.buttonList.map((function(e,t){return Object(c.jsx)("div",{children:Object(c.jsx)(T.a,{style:{width:"100%"},children:e.text})},t)}))]})};S.displayName="NodeTypeButton";var R,I,L=n(165),w=n(166),B=n(167),H=n(161),M=n(154);!function(e){e.nodeTypeInput="nodeTypeInput",e.nodeTypeSelect="nodeTypeSelect",e.nodeTypeButton="nodeTypeButton"}(I||(I={}));var V=(R={},Object(x.a)(R,I.nodeTypeInput,{component:N,label:"Input \u8282\u70b9",icon:L.a}),Object(x.a)(R,I.nodeTypeSelect,{component:E,label:"Select \u8282\u70b9",icon:w.a}),Object(x.a)(R,I.nodeTypeButton,{component:S,label:"Button \u8282\u70b9",icon:B.a}),R),Y=Object.entries(V).map((function(e){var t=Object(d.a)(e,2),n=t[0],c=t[1];return Object(s.a)(Object(s.a)({},c),{},{type:n})})),K=function(e,t){var n={id:Object(H.a)(),coordinates:t,type:e,inputs:[],outputs:[],data:{}};switch(e){case I.nodeTypeInput:n=Object(s.a)(Object(s.a)({},n),{},{outputs:[{id:Object(H.a)(),isLinked:!1}],data:{inputValue:"test"}});break;case I.nodeTypeSelect:n=Object(s.a)(Object(s.a)({},n),{},{outputs:[{id:Object(H.a)(),isLinked:!1}],data:{inputValue:""}});break;case I.nodeTypeButton:var c={buttonList:[{text:"button-1",id:Object(H.a)()},{text:"button-2",id:Object(H.a)()}]},a=c.buttonList.map((function(e){return{id:e.id,isLinked:!1}}));n=Object(s.a)(Object(s.a)({},n),{},{outputs:a,data:c})}return n},Z=function(e){var t=Object(M.a)(e);switch(t.id=Object(H.a)(),t.coordinates=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[e[0]+t,e[1]+t]}(t.coordinates,20),t.type){case I.nodeTypeInput:case I.nodeTypeSelect:t.outputs.forEach((function(e){e.id=Object(H.a)(),e.isLinked=!1}));break;case I.nodeTypeButton:t.data.buttonList.forEach((function(e){e.id=Object(H.a)()})),t.outputs=t.data.buttonList.map((function(e){return{id:e.id,isLinked:!1}}))}return t},Q=n(155),z=function(e,t,n){var c=(null===t||void 0===t?void 0:t.getBoundingClientRect())||{x:0,y:0};return[(e.clientX-c.x)/n,(e.clientY-c.y)/n]},P=function e(t){if(!t)return null;var n=t.id,c=t.classList.contains("diagram-node");return n&&c?n:c?null:e(t.parentElement)},W=function(e,t){return t.findIndex((function(t){return t.id===e}))},F=function(e){var t=e,n=t.offsetHeight,c=t.offsetHeight;return{width:n,height:c,left:t.offsetLeft,top:t.offsetTop,right:t.offsetLeft+n,bottom:t.offsetTop+c}},U=function(e,t,n,c){var a=Object(u.a)(n),o=W(e,a),i=t[0]-n[o].coordinates[0],r=t[1]-n[o].coordinates[1];return c.forEach((function(e){a.some((function(t,n){return t.id===e&&(a[n]=Object(s.a)(Object(s.a)({},a[n]),{},{coordinates:[t.coordinates[0]+i,t.coordinates[1]+r]}),!0)}))})),a[o]=Object(s.a)(Object(s.a)({},a[o]),{},{coordinates:t}),a},X=function(e,t){var n=Object(u.a)(e.nodes),c=W(t,n),a=e.nodes[c],o=a.outputs.map((function(e){return e.id})),i=a.inputs.map((function(e){return e.id}));return n.splice(c,1),{links:e.links.filter((function(e){return!i.includes(e.output)&&!o.includes(e.input)&&e.input!==t&&e.output!==t})),nodes:n}},G=function(e){return document.activeElement===e},q=n(5),J=n.n(q),_=o.a.memo((function(e){var t=e.id,n=e.isLinked,o=e.index,i=e.nodeId,r=e.onDragNewSegment,u=e.onSegmentFail,s=e.onSegmentConnect,d=e.onShowSelectModel,l=e.onPortMount,b=e.type,p=Object(a.useContext)(f).canvasRef,O=j(),v=Object(a.useRef)(null),m=Object(a.useRef)(),h=J()("diagram-port",{"type-input":"input"===b,"type-output":"output"===b,"is-linked":n}),g=A({ref:v,throttleBy:15}),y=g.onDragStart,x=g.onDrag,k=g.onDragEnd;return y((function(e){if(e.stopImmediatePropagation(),e.stopPropagation(),p&&v.current){var t=p.getBoundingClientRect(),n=t.x,c=t.y,a=v.current.getBoundingClientRect(),o=a.x,i=a.y,r=a.width,u=a.height;m.current=[(o-n+r/2)/O,(i-c+u/2)/O]}})),x((function(e){if(m.current){e.stopImmediatePropagation(),e.stopPropagation();var n=z(e,p,O);r(t,m.current,n)}})),k((function(e){var n=e.target;if(n.classList.contains("diagram-port")&&n.id!==t)s(t,n.id);else{var c=P(e.target);if(c&&c!==i)s(t,c);else{var a=document.getElementById("diagram-panel");a&&a.contains(e.target)&&d(e,t),u&&u(t,b)}}})),Object(a.useEffect)((function(){l(t,v.current)}),[t,l]),Object(c.jsx)("div",{className:h,id:t,ref:v,style:{top:0===o?"45%":"calc(45% + ".concat(18*o,"px)")}})})),$=function(e){var t=e.inputs,n=e.onPortMount,a=e.onDragNewSegment,o=e.onSegmentFail,i=e.onSegmentConnect,r=e.onShowSelectModel,u=e.nodeId,s=e.type;return Object(c.jsx)(c.Fragment,{children:t.map((function(e,t){return Object(c.jsx)(_,{onPortMount:n,onDragNewSegment:a,onSegmentFail:o,onShowSelectModel:r,onSegmentConnect:i,type:s,id:e.id,index:t,isLinked:e.isLinked,nodeId:u},e.id)}))})};$.displayName="DiagramNodePorts";var ee=n(168),te=n(169),ne=function(e){var t=e.onNodeDelete,n=e.onNodeCopy,o=e.id,i=Object(a.useCallback)((function(){t(o)}),[o,t]),r=Object(a.useCallback)((function(){n(o)}),[o,n]);return Object(c.jsxs)("div",{className:"diagram-node-action",children:[Object(c.jsx)(T.a,{onClick:r,icon:Object(c.jsx)(ee.a,{})}),Object(c.jsx)(T.a,{onClick:i,icon:Object(c.jsx)(te.a,{})})]})};ne.displayName="DiagramNodeActionButtons";var ce=n(133),ae=n(134),oe=function(){function e(){Object(ce.a)(this,e),this.es={}}return Object(ae.a)(e,[{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.es[e]||(this.es[e]=[]),this.es[e].push({cb:t,once:n})}},{key:"once",value:function(e,t){this.on(e,t,!0)}},{key:"fire",value:function(e){for(var t=this.es[e]||[],n=t.length,c=arguments.length,a=new Array(c>1?c-1:0),o=1;o<c;o++)a[o-1]=arguments[o];for(var i=0;i<n;i++){var r=t[i],u=r.cb,s=r.once;u.apply(this,a),s&&(t.splice(i,1),i--,n--)}}},{key:"off",value:function(e,t){if(void 0===e)this.es={};else if(void 0===t)delete this.es[e];else for(var n=this.es[e]||[],c=n.length,a=0;a<c;a++)n[a].cb===t&&(n.splice(a,1),a--,c--)}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),c=1;c<t;c++)n[c-1]=arguments[c];this.fire.apply(this,[e].concat(n))}}]),e}();oe.ver="__VERSION__";var ie="NODE_MOVING",re="NODE_MOVE_END",ue="AUTO_LAYOUT",se=new oe,de=o.a.memo((function(e){var t,n=e.nodeInfo,i=e.onNodeValueChange,r=e.onNodePositionChange,u=e.onPortMount,d=e.onDragNewSegment,l=e.onNodeMount,f=e.onSegmentFail,b=e.onSegmentConnect,p=e.onShowSelectModel,O=e.onAddHistory,v=e.onToggleActiveNodeId,m=e.isActive,h=e.onNodeDelete,g=e.onNodeCopy,y=n.id,x=n.coordinates,k=n.type,C=n.inputs,N=n.data,D=n.outputs,E=j(),T=null===(t=V[k])||void 0===t?void 0:t.component,S={value:N,onChange:function(e){i(y,e)}},R=Object(a.useRef)(null),I=A({throttleBy:14,ref:R}),L=I.onDragStart,w=I.onDrag,B=I.onDragEnd,H=Object(a.useRef)(x);L((function(){H.current=x})),w((function(e,t){e.stopImmediatePropagation(),e.stopPropagation();var n=[H.current[0]+t.offset[0]/E,H.current[1]+t.offset[1]/E];r(y,n),se.emit(ie,y,n)})),B((function(e){Object(Q.a)(H.current,x)||O(y,H.current),se.emit(re)}));var M=Object(a.useCallback)((function(e){e.shiftKey&&v(y)}),[y,v]),Y={nodeId:y,onPortMount:u,onDragNewSegment:d,onSegmentFail:f,onSegmentConnect:b,onShowSelectModel:p};Object(a.useEffect)((function(){l(y,R.current)}),[y,l]);var K=Object(a.useMemo)((function(){return J()("diagram-node",{active:m})}),[m]);return Object(c.jsxs)("div",{id:y,className:K,ref:R,style:{left:x[0],top:x[1]},onClick:M,children:[T&&o.a.createElement(T,S),Object(c.jsx)($,Object(s.a)(Object(s.a)({inputs:C},Y),{},{type:"input"})),Object(c.jsx)($,Object(s.a)(Object(s.a)({inputs:D},Y),{},{type:"output"})),Object(c.jsx)(ne,{id:y,onNodeDelete:h,onNodeCopy:g})]})}));de.displayName="DiagramNode";var le=o.a.memo((function(e){var t=e.nodes,n=e.activeNodeIds,a=Object(O.a)(e,["nodes","activeNodeIds"]);return Object(c.jsx)(c.Fragment,{children:t.map((function(e){return Object(c.jsx)(de,Object(s.a)({isActive:n.includes(e.id),nodeInfo:e},a),e.id)}))})}));le.displayName="NodesCanvas";var fe=function(e){return[Math.floor(e[0]),Math.floor(e[1])]},be=function(e,t){var n,c=[(t[0]+e[0])/2,e[1]],a=[(t[0]+e[0])/2,t[1]];return"M ".concat(e[0],",").concat(e[1]," C ").concat((n=[c,a],n.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" "))," ").concat(t[0],",").concat(t[1])},je=function(e,t){var n=(e[0]+t[0])/2,c=(e[1]+t[1])/2;return"M".concat(e[0],",").concat(e[1]," ").concat(e[0]+20,",").concat(e[1]," C ").concat(e[0]+100,",").concat(e[1]," ").concat(e[0]+130,",").concat((c+e[1])/2,"  ").concat(n,",").concat(c," C ").concat(n,",").concat(c," ").concat(t[0]-130,",").concat((c+t[1])/2," ").concat(t[0]-2,",").concat(t[1]," M ").concat(t[0]-2,",").concat(t[1]," ").concat(t[0],",").concat(t[1])},pe=function(e,t){if(!e||!t)return"";var n,c,a=fe(e),o=fe(t);return n=a,(c=o)[0]>=n[0]?be(n,c):je(n,c)},Oe=o.a.memo((function(e){var t=e.position,n=e.onDelete;return Object(c.jsx)("foreignObject",{x:t[0],y:t[1],children:Object(c.jsx)("div",{className:"bi-diagram-link-label",children:Object(c.jsx)(te.a,{onClick:n})})})}));Oe.displayName="LinkDelete";var ve=o.a.memo((function(e){var t=e.input,n=e.output,o=e.link,i=e.onDelete,r=Object(a.useRef)(null),u=Object(a.useState)(),s=Object(d.a)(u,2),l=s[0],f=s[1],b=Object(a.useMemo)((function(){return pe(t,n)}),[t,n]);Object(a.useEffect)((function(){r.current&&f(function(e){if(e.getTotalLength&&e.getPointAtLength){var t=e.getTotalLength()/2,n=e.getPointAtLength(t);return[n.x,n.y]}return[0,0]}(r.current))}),[r,t,n]);var j=Object(a.useCallback)((function(){i(o)}),[i,o]);return Object(c.jsxs)("g",{className:"diagram-link",children:[Object(c.jsx)("path",{d:b,className:"bi-link-ghost"}),Object(c.jsx)("path",{d:b,ref:r,className:"bi-link-path"}),l&&Object(c.jsx)(Oe,{position:l,onDelete:j})]})}),(function(e,t){return Object(Q.a)(e,t)}));ve.displayName="Link";var me=function(e,t,n,c){for(var a=0;a<t.length;a++){if(t[a].id===n){var o=c[n];return o?[e[0]+o.offsetLeft+o.offsetWidth/2,e[1]+o.offsetTop+o.offsetHeight/2]:null}}return null},he=function(e,t,n,c,a){for(var o=0;o<e.length;o++){var i=e[o];if(i.id===t){var r=n[t];return r?[i.coordinates[0],i.coordinates[1]+r.offsetHeight/2]:null}var u=me(i.coordinates,i.inputs,t,c);if(u)return u;var s=me(i.coordinates,i.outputs,t,c);if(s)return s}return null},ge=o.a.memo((function(e){var t=e.nodes,n=e.onDelete,o=e.links,i=Object(a.useContext)(f),r=i.canvasRef,u=i.portRefs,s=i.nodeRefs,d=Object(a.useMemo)((function(){var e=[];return o.forEach((function(n){var c=n.input,a=n.output,o=he(t,c,s,u),i=he(t,a,s,u);o&&i&&e.push({link:n,startCoordinates:o,endCoordinates:i})})),e}),[t,o,s,u,r]);return Object(c.jsx)("svg",{className:"diagram-link-canvas",children:d.map((function(e){return Object(c.jsx)(ve,{link:e.link,input:e.startCoordinates,output:e.endCoordinates,onDelete:n},"".concat(e.link.input,"-").concat(e.link.output))}))})}));ge.displayName="LinksCanvas";var ye=o.a.memo((function(e){var t=e.segment,n=t.from,o=t.to,i=t.id,r=Object(a.useMemo)((function(){return pe(n,o)}),[n,o]);return Object(c.jsx)("svg",{className:"diagram-segment-canvas",children:Object(c.jsxs)("g",{className:"diagram-segment-link",id:i,children:[Object(c.jsx)("path",{d:r}),Object(c.jsx)("circle",{r:"5",cx:o[0],cy:o[1]})]})})}));ye.displayName="Segment";n(150);var Ae=function(e){var t=Object(a.useRef)(e);return Object(a.useLayoutEffect)((function(){t.current=e})),Object(a.useMemo)((function(){return function(){var e=t.current;return e.apply(void 0,arguments)}}),[])},xe=function(e){var t=e.type,n=e.onChange,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(a.useEffect)((function(){return se.on(t,n),function(){se.off(t,n)}}),[t,n].concat(Object(u.a)(c)))},ke=function(e){var t=e,n=t.offsetWidth,c=t.offsetHeight;return{width:n,height:c,left:t.offsetLeft,top:t.offsetTop,right:t.offsetLeft+n,bottom:t.offsetTop+c}},Ce=function(e,t){return Math.abs(e-t)<=3},Ne=o.a.memo((function(e){var t=e.onNodePositionChange,n=Object(a.useRef)(null),o=Object(a.useCallback)((function(){n.current&&n.current.childNodes.forEach((function(e){var t=e;"visible"===t.style.visibility&&(t.style.visibility="hidden")}))}),[n]),i=Object(a.useCallback)((function(e,c){o();var a=document.getElementById(e);if(a){var i=ke(a);Array.from(document.querySelectorAll(".diagram-node")).forEach((function(a){if(e!==a.id){var o,r,s,d,l,f,b,j,p=ke(a),O=p.top,v=p.left,m=p.bottom,h=p.right,g={top:[{isNearly:Ce(i.top,O),lineNode:null===(o=n.current)||void 0===o?void 0:o.childNodes[0],line:"x-top",dragShift:O,lineShift:O},{isNearly:Ce(i.bottom,O),lineNode:null===(r=n.current)||void 0===r?void 0:r.childNodes[0],line:"x-top",dragShift:O-i.height,lineShift:O},{isNearly:Ce(i.top,m),lineNode:null===(s=n.current)||void 0===s?void 0:s.childNodes[1],line:"x-bottom",dragShift:m,lineShift:m},{isNearly:Ce(i.bottom,m),lineNode:null===(d=n.current)||void 0===d?void 0:d.childNodes[1],line:"x-bottom",dragShift:m-i.height,lineShift:m}],left:[{isNearly:Ce(i.left,v),lineNode:null===(l=n.current)||void 0===l?void 0:l.childNodes[2],line:"y-left",dragShift:v,lineShift:v},{isNearly:Ce(i.right,v),lineNode:null===(f=n.current)||void 0===f?void 0:f.childNodes[2],line:"y-left",dragShift:v-i.width,lineShift:v},{isNearly:Ce(i.left,h),lineNode:null===(b=n.current)||void 0===b?void 0:b.childNodes[3],line:"y-right",dragShift:h,lineShift:h},{isNearly:Ce(i.right,h),lineNode:null===(j=n.current)||void 0===j?void 0:j.childNodes[3],line:"y-right",dragShift:h-i.width,lineShift:h}]};Object.keys(g).forEach((function(n){g[n].forEach((function(a){if(a.isNearly){a.lineNode&&(a.lineNode.style[n]="".concat(a.lineShift,"px"),a.lineNode.style.visibility="visible");var o=Object(u.a)(c);o="top"===n?[c[0],a.dragShift]:[a.dragShift,c[1]],Object(Q.a)(o,c)||t(e,o)}}))}))}}))}}),[o,t]);return xe({type:ie,onChange:i}),xe({type:re,onChange:o}),Object(c.jsxs)("div",{className:"mark-line",ref:n,children:[Object(c.jsx)("div",{className:"mark-line-item x-direction","data-mark-line-id":"x-top"}),Object(c.jsx)("div",{className:"mark-line-item x-direction","data-mark-line-id":"x-bottom"}),Object(c.jsx)("div",{className:"mark-line-item y-direction","data-mark-line-id":"y-left"}),Object(c.jsx)("div",{className:"mark-line-item y-direction","data-mark-line-id":"y-right"})]})}));Ne.displayName="MarkLine";var De=o.a.memo((function(e){var t=e.position,n=e.onChange;if(!t)return null;var a=function(e){n(e.currentTarget.dataset.type)};return r.a.createPortal(Object(c.jsx)("div",{className:"select-model",onClick:function(){n()},children:Object(c.jsx)("ul",{className:"select-model-content",style:{left:t[0],top:t[1],position:"absolute"},onClick:function(e){e.stopPropagation()},children:Y.map((function(e){return Object(c.jsxs)("li",{className:"select-model-item",onClick:a,"data-type":e.type,children:[e.icon&&o.a.createElement(e.icon),Object(c.jsx)("div",{className:"select-model-text",children:e.label})]},e.type)}))})}),document.body)}));De.displayName="SelectModel";var Ee=n(160),Te=n(164),Se=n(156),Re=function(e,t){for(var n=0;n<e.length;n++){if(e[n].id===t)return!0}return!1},Ie=function(e,t){for(var n=0;n<t.length;n++){var c=t[n];if(c.id===e)return c.id;if(Re(c.inputs,e))return c.id;if(Re(c.outputs,e))return c.id}return e},Le=function e(t,n,c,a,o,i){if(!i.includes(t)){i.push(t);var r=a.findIndex((function(e){return e.id===Ie(t,a)}));a[r].row=c,a[r].column=n,n++,a[r].outputs.forEach((function(t){var r=o.find((function(e){return e.input===t.id}));r&&e(r.output,n,c,a,o,i)}))}};function we(e,t){var n=e.links,c=void 0===n?[]:n,a=e.nodes,o=1,i=(void 0===a?[]:a).map((function(e){return Object(s.a)(Object(s.a)({},e),{},{row:0,column:0,style:F(t[e.id])})}));c.forEach((function(e){if(function(e,t,n){return!t.find((function(t){return t.output===Ie(e,n)}))}(e.input,c,i)){var t=Ie(e.input,i),n=[t],a=i.findIndex((function(e){return e.id===t}));i[a].row=i[a].row||o,i[a].column=1,Le(e.output,2,o,i,c,n),o++}})),i.forEach((function(e){0===e.row&&(e.row=o,e.column=1,o++)})),Object(u.a)(i).forEach((function(e){var t=e.outputs,n=[];t.forEach((function(e){if(e.isLinked){var t=c.find((function(t){return t.input===e.id}));t&&n.push(t.output)}})),i.sort((function(e,t){return n.findIndex((function(t){return e.id===t}))-n.findIndex((function(e){return t.id===e}))}))}));var r=Object(Ee.a)(i,(function(e){return e.row})),d=100,l=100;Object.values(r).forEach((function(e){var t=Object(Ee.a)(e,(function(e){return e.column})),n=Object.values(t).map((function(e){var t=l;return e.forEach((function(e){e.coordinates=[250*(e.column-1)+d,t],t+=e.style.height+50})),e.reduce((function(e,t){return t.style.height+e+50}),0)})),c=Object(Te.a)(n)||0;l+=c}));var f=i.map((function(e){return Object(s.a)({},Object(Se.a)(e,"column","row","style"))}));return{links:c,nodes:f}}var Be=o.a.memo((function(e){var t=e.value,n=e.onChange,o=e.onAddHistory,i=e.transform,r=e.activeNodeIds,l=e.onToggleActiveNodeId,f=Object(a.useState)(),b=Object(d.a)(f,2),j=b[0],O=b[1],v=Object(a.useState)(),m=Object(d.a)(v,2),h=m[0],g=m[1],y=Object(a.useRef)({}).current,A=Object(a.useRef)({}).current,x=Object(a.useRef)(),k=Ae((function(e,c){var a=U(e,c,t.nodes,r);n(Object(s.a)(Object(s.a)({},t),{},{nodes:a}),!0)})),C=Ae((function(e,c){var a=Object(u.a)(t.nodes),o=W(e,a);a[o]=Object(s.a)(Object(s.a)({},a[o]),{},{data:c}),n(Object(s.a)(Object(s.a)({},t),{},{nodes:a}))})),N=Ae((function(e,n){var c=U(e,n,t.nodes,r);o(Object(s.a)(Object(s.a)({},t),{},{nodes:c}))})),D=Ae((function(e){var c=W(e,t.nodes),a=Z(t.nodes[c]);n(Object(s.a)(Object(s.a)({},t),{},{nodes:[].concat(Object(u.a)(t.nodes),[a])}))})),E=Ae((function(e){var c=X(t,e);n(c)})),T=Ae((function(e,t){y[e]=t})),S=Ae((function(e,t){A[e]=t})),R=Object(a.useCallback)((function(e,t,n){O({id:"segment-".concat(e),from:t,to:n})}),[]),I=Object(a.useCallback)((function(){O(void 0)}),[]),L=Ae((function(e,t){x.current=t,g([e.clientX,e.clientY]),O(void 0)})),w=Ae((function(e,c){if(!(t.links.findIndex((function(t){return t.input===e&&t.output===c}))>-1)){var a=[].concat(Object(u.a)(t.links),[{input:e,output:c}]);n(Object(s.a)(Object(s.a)({},t),{},{links:a}))}O(void 0)})),B=Ae((function(e){var c=t.links.filter((function(t){return!Object(Q.a)(t,e)}));n(Object(s.a)(Object(s.a)({},t),{},{links:c}))})),H=Ae((function(e){if(e&&h){var c=z({clientX:h[0],clientY:h[1]},document.getElementById("diagram-canvas"),i.scale),a=K(e,c);n(Object(s.a)(Object(s.a)({},t),{},{nodes:[].concat(Object(u.a)(t.nodes),[a])})),setTimeout((function(){w(x.current||"",a.id)}),20)}g(void 0)})),M=Object(a.useCallback)((function(){var e=we(t,A);n(e)}),[t,A,n]);return xe({type:ue,onChange:M}),Object(c.jsxs)(p,{portRefs:y,nodeRefs:A,transform:i,children:[Object(c.jsx)(le,{nodes:t.nodes,onNodeMount:S,onPortMount:T,onDragNewSegment:R,onSegmentFail:I,onShowSelectModel:L,onNodePositionChange:k,onNodeValueChange:C,onNodeDelete:E,onNodeCopy:D,onSegmentConnect:w,onAddHistory:N,onToggleActiveNodeId:l,activeNodeIds:r}),t.links.length>0&&Object(c.jsx)(ge,{nodes:t.nodes,links:t.links,onDelete:B}),j&&Object(c.jsx)(ye,{segment:j}),Object(c.jsx)(Ne,{onNodePositionChange:k}),Object(c.jsx)(De,{position:h,onChange:H})]})}));Be.displayName="Diagram";var He={past:[],present:null,future:[]},Me=function(e,t){var n=e.past,c=e.present,a=e.future,o=t.newPresent;switch(t.type){case"UNDO":var i=n[n.length-1];return{past:n.slice(0,n.length-1),present:i,future:[c].concat(Object(u.a)(a))};case"REDO":var r=a[0],d=a.slice(1);return{past:[].concat(Object(u.a)(n),[c]),present:r,future:d};case"SET":return{past:Object(u.a)(n),present:o,future:[]};case"SET_WIDTH_HISTORY":return o===c?e:{past:[].concat(Object(u.a)(n),[c]),present:o,future:[]};case"ADD_A_HISTORY":return o===c?e:{past:[].concat(Object(u.a)(n),[o]),present:c,future:[]};case"CLEAR":var l=t.initialPresent;return Object(s.a)(Object(s.a)({},He),{},{present:l})}},Ve=n(162),Ye=(n(119),n(135)),Ke=/macintosh|mac os x/i.test(navigator.userAgent)?"CMD":"Ctrl",Ze=[{text:"\u64a4\u9500",hotKeys:[{key:Ke},{key:"Z"}]},{text:"\u591a\u9009",hotKeys:[{key:"Shift"},{icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAE8ElEQVRoQ+2ZbWibVRTH/+c+6YugTKjMTVaoTBRBcFBRHCpVvw3FJmkc7sv8IO1sm3RTaZNqWdyHPunswCVrXQu6itjh0jRxU/ZpWFEYsk0niqK2UFDsVrYxcYy+5LlHbmpqDGlznydFWmy/tfe8/H/3nHse7i1hjf9QKfobAqHzyn8kaj5USpxSfIsC+Hw+Ix6PW4WSrHoAd0voGSHYOzd7reXU4ODNfIhVDeALh8v56kwKRBsl0zfzs1fa8iFWNYDa7fo9wRqjjAaIUCUZ56/9ObV3bGhoJluJVQ+QD8GSzonL5W3xeHhOra0JgByIo0S4QzKPjcYiry01Odx7Oh8QLmxj4hoibGCGC8zXSdAkW/SdMf3Lt0sNBSfTqOgUygZ9rvn16jIXH5YkzdHDkXO5ydSkkpu2Pg/gBSK6azkhDFwH4yNhVRyP94dvOBGd66MNoJwKjVR3c/v9hss4AODuQmKYuR+SbzCJGiKuI6KNyo4ZVyRgJmPm56VA2ALIT+RuDT4lBHUT4FpKRBrclIpGLmTX3c0djwlD+ImwdQGE+xOxyHtOIQoCZA9nftDcL25GiEv0Lide+ecDZCspN9/TRsCujA3zoVQsctwJhCMAz97OzWTJYSK6rVjSQgBZH28gtJsAPysGi5pH+7q/LhYvf91RC3kCoR4BPK2TbDkA5e8JdB4Q4B0MnhRTEzvtTijbAO6W0L2GgWEd8Uu10L8mWHP4VmnMnFLVTEvZlTrSc1o3trKzDeBtDQVJoEE3SbEKqDje1mAjCWpk4GIiar6kG9sZQCD0KQF36ibRAfD427cIMlIZQemKOjvfB1sV8DV2bOBKcUZXvE4LLR5ofyhJhGrLgj/ZZ57VzWELwO3veNAg8a5ucDsAnkAoKoDtsBAe6TM/0c1hC6A+EKx1gQZ0g9sCaA3uF4KeZSCWiJrv6+ZYhQA8mIhGBtcBCu1AtoXUR4csGtLZJQs4m+wzrxaz9Sy20H9QAQZfSEQjTcVE2VlfB9DZrZwWWq9A/oatt9D/q4UYE4mYuVMHWtdmsYUkm4kjkYSun60v8d8X+A+YcTMRM5/QTaJj520NDpCgWkjZNWLjTmALwLdv3y1sVX6hBFlz8zuSR3undcTp2Hj9wc/UpcYCvZiMdn+v4+P0PvAhAfcx86GEw4t4vrj6l4O1rjIaYNCsmCp/MvvypwNhqwIq4OLtifGruDTeYPcOW0iUxx/sFUR1EjgzGjU7dIRnbWwDuFtCVcKgkwSuWIkq5N4x0vPclHrnnzckHRDbAJkqBEKvqDcddZilZTUl+w/+qJMs32ZhM/gYQT1H0lcj0e4Wu3EcAajDLNOVw+oKmHkilAgk+8yf7STPiBfoVy90aiMY1q7R2MHf7MRwdIizCRb+d4BjanJkKgG87bo0/rHOmaj3tz9skLE/8zjAsCxLvprs7/nSrviSAJSzeiMSgmNEVKV+Z+AnCXnCNYOx+GDPH7mCfL5weXrT7KPE8AqB7Rn7BfCuUh54HbVQrjDVCobAGyA8nvt3Bi4T6HcQWyxxO4irCVSRtWHGDxbSb6Zib0042XnHU2ipZGqWizLaLRiPgGAsZaeEk8QJmh4/rdNuxeBKrkChycKwtgkyagDekulTommL5aSYMy6ODnZPFRNlZ33FAewkXwnbdYCV2MVSYqxXoJTdWwnfNV+BvwALEYtPTIIeoAAAAABJRU5ErkJggg=="}]},{text:"\u91cd\u505a",hotKeys:[{key:Ke},{key:"Shift"},{key:"Z"}]},{text:"\u5168\u9009",hotKeys:[{key:Ke},{key:"A"}]},{text:"\u590d\u5236",hotKeys:[{key:Ke},{key:"C"}]},{text:"\u7f29\u653e",hotKeys:[{icon:"data:image/png;base64,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"}]},{text:"\u7c98\u8d34",hotKeys:[{key:Ke},{key:"V"}]},{text:"\u79fb\u52a8\u753b\u5e03",hotKeys:[{key:"Space"},{icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAFiUlEQVRoQ+2Zf2hbVRTHzzkvbVNxWFEclQ4L/kJRLEwGGwjCZLAxMT8WpkNh+8N2tEnbqbRJEFfYTLLZuZH0hwuoFXQiaX6IIuyPgsoUNiwIE8fKKsrAlTFBmbq2y7tH7mtfeE1/vNs0td1o/0pz3zvnfO75nnPfO0G4xf/wFo8flAHcgc6nUDj+zPS+/dtqglYCkMETUAIA/mVBTasJwhbADB4R7pA7zwzXVhPEggDultA9SPAmIm9AwHoDAOAiM/yqOcYPp44fv7HScrLNgAxwV0toJ2jQJT/ngZty8djwSgdu+r/9AKTmWfC9ud6jQyalq6Vjq0bUJv8XSOFsPPKTueb1B73M2g8rVdgzMlDoNiySPKkZAJqj8nqqr+tvq2R8jZ136aAZRY1OfgkYtq1UYRcAiruNGTADJ9PxWNIK4PEHDxLh89bv7LqThE4lj/xV7topAOzyh+JAsKXYgSqA0aEEJ9M9saSnMVyLVbqLATchQD0iritsCMM1QDgvQJxx5KuHirO7WMACgO/AgWqhOxMI0MAAP7Lgy0ZQiF9nE9FvrIbdLZ0vIGKDISHCRxDgUcH8KWh0CnVoQ+TnZm8ETiBw1cys8XUAPEVjVR+lUl2Tiw3e8D9D2yaEDrnB3uiX5ppxHlTgA0ZNTFaOWHfN2xpsZIZ1LPAiEXSYB95cmaQrzoGbd/+zQaukzUC0XYJPH46XWFBnKY1gVhuVmchPOjdke6MjZhALnQOu/cF6qIDNDsTXF9rBuaToag5u0xzYhgDrmfm6QApYO5xKRpZ8DrhbQju16UNusQDyepldIu5GxCeNRqDhvsyJyBWV4GdJqPgm9/437kNnZR3qYgsi7p1ax25BMKLhjQs6V9egzp/NJ5sZep+jm5nrRv3lnQOI8CAzn08nYvvKAmAtbKtBWbCZROyYpzV0hAC2qjibS0LW+zzt4VoUMCgLXdehK2upwYXs20qoGKIQfKCjjlDLqQRvFOoCGTBteP3BRiSUTeFSOhF9UcW2LYA0YkIw8wW58/I7byD0KiI0qThRBXDtba9xrKs+DQiarsMeayOZz48SgAHh66q09mpvIPihLLxyAkhbnkCojxA2scAT6Z7Ix3b2lQGKDXkDoW9Vite8T0VCRmZbg40I2CgAv8rEI28tC4DMBtdOfG9nXLULWa8zzxwGHk7HY7YSLSkD8lmHnPzFcgC4WoMbHYAn1wAW2t3bKgOD8ejTi5GS3bX/u4TWAIpSspYBO40ap6Wlja5JaE1CKpopusb6KIHa+DPlnJHu8nduB6JDy3oSTz10hb+TLx/58fzuXPKd0RL2Yc5bvP7wy0jcLgQMZXqinXZ2S3oWmgIIfSKnCjqIQ9n4kc/tHKmuewLBbkJ8lhn70onIB3b3lQ7gD7ch8SuC4VwmEW22c6Sy7mvuulM4xk8jYFX+Jjfl+u2n4CUDuFvDT2jAAzIw1bcnOwjzLY+Z/6Cx0R2pVEq3u6dkAKuM5CSPrlxqUnE4X0ByAkIVFYPyJckcUdoFL9eXBCAHwhrS+9IQA5xKx6PvqjgtvmZ6rHISER5n4N9Jm9it2tmWBDCdhdcQYI8BwTxAY6P9i8mE1L3umDhBAA3AoOdBD+QSR8+pbsSSAXw+n6avfyhCZM6H8CzfFMfS/bFf7IJwt4Q2k8YhBLzfqCWGSDYRzdjdZ11fMoA0ZkDUPnyQgHdMyynPzGcE8xDm9eHse91XTaeeQEcdI24kRpc51WDACaFzVHWYVXYA06B8IWcN2hGgxuqEjd8G+Sri1E7PWGP4WQg4rDIDmiszZcmA1bDRy2nSBcSF8fksxwy6QDjLDOni3x4WI58ldyE7Z3LyDJp4TNOphpGrkHFCJ3HZ4ZgcUe0ydj7KngE7h+Vev+UB/gN5EApeyCXHVgAAAABJRU5ErkJggg=="}]},{text:"\u5220\u9664",hotKeys:[{key:"Del"}]}],Qe=o.a.memo((function(e){return Object(Ye.a)(e),Object(c.jsx)("ul",{className:"shortcuts-panel",children:Ze.map((function(e,t){return Object(c.jsxs)("li",{className:"shortcuts-panel-item",children:[Object(c.jsxs)("div",{className:"shortcuts-panel-title",children:[e.text," :"]}),Object(c.jsx)("div",{className:"shortcuts-panel-list",children:e.hotKeys.map((function(t,n){return Object(c.jsxs)(o.a.Fragment,{children:[n>0&&Object(c.jsx)("span",{className:"shortcuts-panel-plus",children:"+"}),Object(c.jsxs)("div",{className:"shortcuts-panel-key",children:[t.key,t.icon&&Object(c.jsx)("img",{className:"shortcuts-panel-icon",src:t.icon,alt:e.text})]})]},n)}))})]},t)}))})})),ze=o.a.memo((function(e){var t=e.undo,n=e.redo,o=e.canUndo,i=e.canRedo,r=e.scale,u=Object(a.useCallback)((function(){se.emit(ue)}),[]);return Object(c.jsxs)("div",{className:"toolbar",children:[Object(c.jsxs)(T.a,{disabled:!0,children:[100*r,"%"]}),Object(c.jsx)(T.a,{disabled:!o,onClick:t,children:"\u64a4\u9500"}),Object(c.jsx)(T.a,{disabled:!i,onClick:n,children:"\u91cd\u505a"}),Object(c.jsx)(Ve.a,{trigger:"click",placement:"right",content:Object(c.jsx)(Qe,{}),overlayClassName:"scale-popover",children:Object(c.jsx)(T.a,{children:"\u5feb\u6377\u952e"})}),Object(c.jsx)(T.a,{onClick:u,children:"\u81ea\u52a8\u6392\u5217"})]})})),Pe=(n(120),o.a.memo((function(e){var t=e.icon,n=e.label,i=e.type,r=Object(a.useCallback)((function(e){var t;null===(t=e.dataTransfer)||void 0===t||t.setData("nodeType",i)}),[i]);return Object(c.jsxs)("div",{className:"node-list-item",draggable:!0,onDragStart:r,children:[t&&o.a.createElement(t),Object(c.jsx)("div",{className:"node-list-text",children:n})]})})));Pe.displayName="NodeListItem";var We=Object(a.memo)((function(){return Object(c.jsx)("div",{className:"node-list",children:Y.map((function(e){return Object(c.jsx)(Pe,{icon:e.icon,type:e.type,label:e.label},e.type)}))})}));We.displayName="NodeList";var Fe=n(52);var Ue,Xe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,c=arguments.length>3?arguments[3]:void 0,o=Object(a.useRef)();Object(a.useEffect)((function(){o.current=t}),[t]),Object(a.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return o.current(e)};return n.addEventListener(e,t,c),function(){n.removeEventListener(e,t)}}}),[e,n,c])},Ge=.1,qe="DEFAULT",Je="START",_e="MOVE",$e="SELECTION",et=(Ue={},Object(x.a)(Ue,qe,"default"),Object(x.a)(Ue,$e,"default"),Object(x.a)(Ue,Je,"grab"),Object(x.a)(Ue,_e,"grabbing"),Ue),tt={links:[{input:"port-1",output:"node-2"},{input:"port-5",output:"841e9704-c295-4915-8ba9-1d8ab4e6b172"},{input:"d0ce404a-d95c-4210-be5d-106cb707ecda",output:"0d8dcb00-7c54-488a-9e85-0f92cb463cc3"},{input:"1751249f-fb2c-44ed-b324-e99cf1d8a5fd",output:"1a5f12bc-9d9c-48e2-905d-97e865845e87"}],nodes:[{id:"node-1",coordinates:[100,100],inputs:[],outputs:[{id:"port-1",isLinked:!0}],type:"nodeTypeInput",data:{inputValue:"defaultValue"}},{id:"841e9704-c295-4915-8ba9-1d8ab4e6b172",coordinates:[600,100],type:"nodeTypeInput",inputs:[],outputs:[{id:"62852bf6-4cb8-4437-8cb9-d1edce72de1b",isLinked:!1}],data:{inputValue:"test"}},{id:"ebac3f07-598e-4e2f-9e81-e67e542322d8",coordinates:[364,353],type:"nodeTypeButton",inputs:[],outputs:[{id:"d0ce404a-d95c-4210-be5d-106cb707ecda",isLinked:!1},{id:"1751249f-fb2c-44ed-b324-e99cf1d8a5fd",isLinked:!1}],data:{buttonList:[{text:"button-1",id:"d0ce404a-d95c-4210-be5d-106cb707ecda"},{text:"button-2",id:"1751249f-fb2c-44ed-b324-e99cf1d8a5fd"}]}},{id:"0d8dcb00-7c54-488a-9e85-0f92cb463cc3",coordinates:[604,353],type:"nodeTypeInput",inputs:[],outputs:[{id:"f854d9bc-0b0e-481c-acfe-786a20483726",isLinked:!1}],data:{inputValue:"input"}},{id:"f57ee82a-2f1e-45e8-905a-187d36a45dbb",coordinates:[100,370],type:"nodeTypeSelect",inputs:[],outputs:[{id:"459c4240-26f7-4351-857d-ba856ca755cb",isLinked:!1}],data:{inputValue:"",selectValue:"lucy"}},{id:"node-2",type:"nodeTypeSelect",coordinates:[367,226],inputs:[{id:"input-1",isLinked:!1}],outputs:[{id:"port-5",isLinked:!1}],data:{selectValue:""}},{id:"1a5f12bc-9d9c-48e2-905d-97e865845e87",coordinates:[597,478],type:"nodeTypeSelect",inputs:[],outputs:[{id:"2d16159f-3f1c-4370-b3fc-28bd8e51c388",isLinked:!1}],data:{inputValue:""}}]};new Array(500).fill({}).map((function(e,t){return{id:"node-"+t,coordinates:[40*t+200,50*t],inputs:[],outputs:[{id:"port-"+t,isLinked:!1}],type:"nodeTypeInput",data:{inputValue:"defaultValue"}}})),new Array(400).fill({}).map((function(e,t){return{input:"port-"+t,output:"node-"+(t+1)}}));function nt(){var e=function(e){var t=Object(a.useReducer)(Me,Object(s.a)(Object(s.a)({},He),{},{present:e})),n=Object(d.a)(t,2),c=n[0],o=n[1],i=0!==c.past.length,r=0!==c.future.length,u=Object(a.useCallback)((function(){i&&o({type:"UNDO"})}),[i,o]),l=Object(a.useCallback)((function(){r&&o({type:"REDO"})}),[r,o]),f=Object(a.useCallback)((function(e){return o({type:"SET",newPresent:e})}),[o]),b=Object(a.useCallback)((function(e){return o({type:"SET_WIDTH_HISTORY",newPresent:e})}),[o]),j=Object(a.useCallback)((function(e){return o({type:"ADD_A_HISTORY",newPresent:e})}),[o]),p=Object(a.useCallback)((function(){return o({type:"CLEAR",initialPresent:e})}),[o,e]);return{present:c.present,set:f,setWithHistory:b,addAHistory:j,undo:u,redo:l,clear:p,canUndo:i,canRedo:r}}(tt),t=e.present,n=e.set,o=e.setWithHistory,i=e.addAHistory,r=e.undo,l=e.redo,f=e.canUndo,b=e.canRedo,j=t,p=Object(a.useState)({scale:1,translateX:0,translateY:0}),O=Object(d.a)(p,2),m=O[0],h=O[1],g=Object(a.useState)(),y=Object(d.a)(g,2),A=y[0],x=y[1],k=Object(a.useState)(qe),C=Object(d.a)(k,2),N=C[0],D=C[1],E=Object(a.useRef)(),T=Object(a.useState)([]),S=Object(d.a)(T,2),R=S[0],I=S[1],L=Object(a.useRef)(null),w=Object(a.useRef)(null),B=Object(a.useRef)([]),H=Object(a.useRef)([]),M=Object(a.useMemo)((function(){var e;return(null===(e=L.current)||void 0===e?void 0:e.getBoundingClientRect())||{x:0,y:0}}),[L.current]),V=Object(a.useCallback)(Object(v.a)((function(e){h(e)}),20),[h]),Y=Object(a.useCallback)((function(e,t){t?n(e):o(e)}),[n,o]),Q=Object(a.useCallback)((function(e){i(e)}),[i]),P=Object(a.useCallback)((function(e){e&&(e=window.event);var t=e.dataTransfer.getData("nodeType"),n=z(e,document.getElementById("diagram-canvas"),m.scale),c=K(t,n);Y(Object(s.a)(Object(s.a)({},j),{},{nodes:[].concat(Object(u.a)(j.nodes),[c])}))}),[Y,m,j]),W=Object(a.useCallback)((function(e){e.preventDefault()}),[]),F=Ae((function(e){var t;if(null===(t=L.current)||void 0===t?void 0:t.contains(e.target)){var n=e.wheelDelta,c=m.scale,a=m.translateX,o=m.translateY,i=(e.clientX-M.x-a)*Ge/c,r=(e.clientY-M.y-o)*Ge/c;n<0&&(c-=Ge,a+=i,o+=r),n>0&&(c+=Ge,a-=i,o-=r),c>1||c<.1||V({scale:Number(c.toFixed(2)),translateX:a,translateY:o})}})),U=Ae((function(e){E.current={x:e.clientX,y:e.clientY,relativeX:e.clientX-m.translateX,relativeY:e.clientY-m.translateY},function(e,t){return e.target===t||e.target===(null===t||void 0===t?void 0:t.firstChild)}(e,L.current)&&(N===Je?D(_e):(D($e),I([])))})),q=Object(a.useCallback)(Object(v.a)((function(e){if(E.current&&L.current){x({left:Math.min(e.clientX,E.current.x)-M.x,top:Math.min(e.clientY,E.current.y)-M.y,width:Math.abs(e.clientX-E.current.x),height:Math.abs(e.clientY-E.current.y)});var t=w.current,n=j.nodes.map((function(e){return e.id})).filter((function(e){return function(e,t){if(e&&t){var n=e.getBoundingClientRect(),c=t.getBoundingClientRect(),a=Math.max(n.x+n.width,c.x+c.width),o=Math.max(n.y+n.height,c.y+c.height),i=Math.min(n.x,c.x),r=Math.min(n.y,c.y);return a-i<=n.width+c.width&&o-r<=n.height+c.height}return!1}(t,document.getElementById(e))}));I(n)}}),20),[m,j]),J=Ae((function(e){D(N===_e?Je:qe),x(void 0),E.current=void 0})),_=Ae((function(e){N===_e&&E.current&&V(Object(s.a)(Object(s.a)({},m),{},{translateX:e.clientX-E.current.relativeX,translateY:e.clientY-E.current.relativeY})),N===$e&&q(e)})),$=Ae((function(e){"keydown"===e.type&&N===qe&&D(Je),"keyup"===e.type&&D(qe)})),ee=Ae((function(e){G(L.current)&&(e.preventDefault(),I(j.nodes.map((function(e){return e.id}))))})),te=Ae((function(){if(G(L.current)&&R.length){var e=Object(s.a)({},j);R.forEach((function(t){e=X(e,t)})),Y(e)}})),ne=Ae((function(e){G(L.current)&&R.length&&(e.preventDefault(),B.current=j.nodes,H.current=R)})),ce=Ae((function(e){if(G(L.current)){e.preventDefault();var t=H.current.map((function(e){var t=B.current.findIndex((function(t){return t.id===e}));return Z(B.current[t])}));Y(Object(s.a)(Object(s.a)({},j),{},{nodes:[].concat(Object(u.a)(j.nodes),Object(u.a)(t))}))}})),ae=Ae((function(e){var t=Object(u.a)(R),n=t.findIndex((function(t){return t===e}));n>-1?t.splice(n,1):t=[].concat(Object(u.a)(t),[e]),I(t)})),oe=Object(a.useMemo)((function(){return et[N]}),[N]),ie=Object(a.useMemo)((function(){return N!==$e}),[N]),re=Object(a.useMemo)((function(){return{left:null===A||void 0===A?void 0:A.left,top:null===A||void 0===A?void 0:A.top,width:null===A||void 0===A?void 0:A.width,height:null===A||void 0===A?void 0:A.height}}),[A]);return Object(Fe.a)("ctrl+z, cmd+z",r,{},[r]),Object(Fe.a)("ctrl+shift+z, cmd+shift+z",l,{},[l]),Object(Fe.a)("ctrl+c, cmd+c",ne,{},[ne]),Object(Fe.a)("ctrl+v, cmd+v",ce,{},[ce]),Object(Fe.a)("ctrl+a, cmd+a",ee,{},[ee]),Object(Fe.a)("del",te,{},[te]),Object(Fe.a)("space",$,{keyup:!0,keydown:!0},[$]),Xe("wheel",F),Xe("mouseup",J),Xe("mousemove",_),Xe("mousedown",U),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{id:"diagram-panel",ref:L,className:"diagram-panel",onDrop:P,onDragEnter:W,onDragOver:W,tabIndex:1,style:{cursor:oe},children:[Object(c.jsx)(Be,{value:j,transform:m,onChange:Y,onAddHistory:Q,activeNodeIds:R,onToggleActiveNodeId:ae}),Object(c.jsx)("div",{ref:w,className:"diagram-selection-area",hidden:ie,style:re})]}),Object(c.jsx)(ze,{undo:r,redo:l,canUndo:f,scale:m.scale,canRedo:b}),Object(c.jsx)(We,{})]})}var ct=Object(a.memo)(nt),at=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,170)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),o(e),i(e)}))};r.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(ct,{})}),document.getElementById("root")),at()},87:function(e,t,n){}},[[151,1,2]]]);
//# sourceMappingURL=main.a62818b8.chunk.js.map