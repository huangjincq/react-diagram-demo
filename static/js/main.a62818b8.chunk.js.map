{"version":3,"sources":["components/Context/DiagramManager.ts","components/Diagram/DiagramCanvas.tsx","hooks/useDrag.ts","components/NodeTypes/NodeTypeHeader.tsx","components/NodeTypes/NodeTypeInput.tsx","components/NodeTypes/NodeTypeSelect.tsx","components/NodeTypes/NodeTypeButton.tsx","components/NodeTypes/config.ts","utils/index.ts","components/Diagram/Port.tsx","components/Diagram/DiagramNodePorts.tsx","components/Diagram/DiagramNodeActionButtons.tsx","utils/onfire.ts","utils/eventBus.ts","components/Diagram/DiagramNode.tsx","components/Diagram/NodesCanvas.tsx","utils/makeSvgPath.ts","components/Diagram/LinkDelete.tsx","components/Diagram/Link.tsx","components/Diagram/LinksCanvas.tsx","components/Diagram/Segment.tsx","hooks/useEventCallback.ts","hooks/useEventBus.ts","components/Diagram/MarkLine.tsx","components/Diagram/SelectModel.tsx","utils/autoLayout.ts","components/Diagram/index.tsx","hooks/useHistory.ts","components/Toolbar/ShortcutsPanel.tsx","static/icon-click.png","static/icon-wheel.png","static/icon-move.png","components/Toolbar/Toolbar.tsx","components/NodeList/NodeListItem.tsx","components/NodeList/NodeList.tsx","hooks/useEventListener.ts","constant/index.ts","utils/creatMockData.ts","DiagramPanel.tsx","constant/hotKeys.ts","reportWebVitals.ts","index.tsx"],"names":["defaultValue","canvasRef","portRefs","nodeRefs","scale","DiagramManagerContext","createContext","DiagramManagerProvider","Provider","useScale","useContext","DiagramCanvas","React","memo","props","children","transform","translateX","translateY","useState","canvasDom","setBoundingBox","useRef","useEffect","current","contextValue","useMemo","id","className","ref","style","value","displayName","DISABLED_DRAG_TAGS","defaultOptions","throttleBy","getEventCoordinates","event","clientX","clientY","CreateCallbackRef","useCallback","callback","useDrag","options","targetRef","dragStartHandlerRef","dragHandlerRef","dragEndHandlerRef","isDragging","start","end","offset","info","onDragStart","targetTagName","target","tagName","contains","includes","onDrag","throttle","onDragEnd","_onDragStart","e","_onDrag","_onDragEnd","addEventListener","document","removeEventListener","NodeTypeHeader","icon","label","createElement","NodeTypeInput","onChange","nodesConfig","nodeTypeInput","inputValue","placeholder","NodeTypeSelect","nodeTypeSelect","width","selectValue","Option","disabled","NodeTypeButton","nodeTypeButton","buttonList","map","button","index","text","NodeTypes","component","AppleOutlined","WindowsOutlined","GithubOutlined","nodesList","Object","entries","key","type","createNode","nodeType","coordinate","nodeData","uuidv4","coordinates","inputs","outputs","data","isLinked","buttonData","item","copyNode","originNode","cloneDeep","distance","offsetCoordinates","forEach","output","calculatingCoordinates","referenceDom","referenceDomRect","getBoundingClientRect","x","y","findEventTargetParentNodeId","dom","nodeId","isNodeDom","classList","parentElement","findIndexById","nodes","findIndex","node","getNodeStyle","nodeDom","offsetHeight","height","left","offsetLeft","top","offsetTop","right","bottom","batchUpdateCoordinates","nextCoordinates","activeNodeIds","nextNodes","offsetCoordinate","activeNodeId","some","nextIndex","oneNodeDelete","currentNode","nodeOutputs","port","nodeInputs","splice","links","filter","link","input","checkIsFocusInPanel","panelDom","activeElement","Port","onDragNewSegment","onSegmentFail","onSegmentConnect","onShowSelectModel","onPortMount","startCoordinatesRef","classnames","stopImmediatePropagation","stopPropagation","canvasX","canvasY","to","targetDom","targetNode","getElementById","DiagramNodePorts","DiagramNodeActionButtons","onNodeDelete","onNodeCopy","handleNodeDelete","handleNodeCopy","onClick","CopyOutlined","DeleteOutlined","OnFire","es","eventName","cb","once","this","push","on","listeners","l","length","params","i","apply","undefined","fire","ver","EVENT_NODE_MOVING","EVENT_NODE_MOVE_END","EVENT_AUTO_LAYOUT","EE","DiagramNode","nodeInfo","onNodeValueChange","onNodePositionChange","onNodeMount","onAddHistory","onToggleActiveNodeId","isActive","nodeItemProps","nextNodeData","dragStartPoint","nextCoords","eventBus","emit","isEqual","handleClick","shiftKey","active","NodesCanvas","others","roundPoint","point","Math","floor","getCubicBezierPath","from","points","controlPointForStart","controlPointForEnd","join","getAdvancedCubicBezierPath","midX","midY","makeSvgPath","startPoint","endPoint","roundedStart","roundedEnd","LinkDelete","position","onDelete","Link","pathRef","labelPosition","setLabelPosition","path","pathElement","getTotalLength","getPointAtLength","midpoint","getPathMidpoint","handleDelete","d","prev","next","findPortCoordinate","nodeCoordinates","ports","entityId","j","portDom","offsetWidth","computedLinkCoordinate","nodeEl","inputRes","outputRes","LinksCanvas","result","res","startCoordinates","endCoordinates","Segment","segment","r","cx","cy","useEventCallback","fn","useLayoutEffect","useEventBus","dep","off","isNearly","dragValue","targetValue","abs","MarkLine","handleHideLine","childNodes","markLine","line","visibility","handleMove","curNodeDom","curNodeStyle","Array","querySelectorAll","nodeStyle","conditions","lineNode","dragShift","lineShift","keys","condition","newCoordinates","data-mark-line-id","SelectModel","prop","handleItemClick","currentTarget","dataset","ReactDOM","createPortal","data-type","body","checkPortIsNodeSon","findPortFatherNodeId","recursionLookup","linkEndId","baseColumn","row","extendNodes","catchNodeIds","nodeIndex","column","findLink","find","autoLayout","linkInput","checkIsStartLink","portFatherNodeId","nextNodeIds","sort","a","b","groupRow","groupBy","LAYOUT_BASIC_COORDINATE","baseRowTop","values","aRow","groupColum","aRowHeightList","aColumn","currentTop","cell","reduce","pre","cur","rowMaxHeight","maxBy","newNodes","omit","Diagram","setSegment","selectModelPosition","setSelectModelPosition","startPortIdRef","handleNodePositionChange","handleNodeValueChange","nextNodeValue","handleAddHistory","newNode","nextValue","onPortRegister","portId","portEl","onNodeRegister","nextLinks","onLinkDelete","handleSelectModelChange","setTimeout","handleAutoLayout","resultValue","initialState","past","present","future","reducer","state","action","newPresent","previous","slice","newFuture","initialPresent","CTRL_OR_CMD","test","navigator","userAgent","hotkeyList","hotKeys","ShortcutsPanel","keyItem","keyIndex","Fragment","src","alt","Toolbar","undo","redo","canUndo","canRedo","trigger","placement","content","overlayClassName","NodeListItem","handleDragStart","dataTransfer","setData","draggable","NodeList","useEventListener","handler","element","savedHandler","eventListener","SCALE_STEP","DRAG_STATE","CURSOR_MAP","fill","DiagramPanel","useReducer","dispatch","set","setWithHistory","addAHistory","clear","useHistory","handleUndo","handleRedo","setTransform","selectionArea","setSelectionArea","dragState","setDragState","mouseDownStartPosition","setActiveNodeIds","panelRef","selectionAreaRef","batchCopyNodesRef","batchCopyActiveNodeIdsRef","panelRect","handleThrottleSetTransform","handleChange","newValue","notAddHistory","handleDrop","window","getData","handleDrag","preventDefault","handleWheel","wheelDelta","offsetX","offsetY","Number","toFixed","handleMouseDown","relativeX","relativeY","firstChild","checkMouseDownTargetIsDrawPanel","handleThrottleSetSelectionArea","min","selectAreaDom","v","dom1","dom2","rect1","rect2","maxX","max","maxY","minX","minY","collideCheck","handleMouseUp","handleMouseMove","handleSpaceHotKey","handleSelectAll","handleBatchDelete","handleBatchCopy","handleBatchPaste","handleToggleActiveNodeId","nextActiveNodeIds","cursor","hideSelectionArea","selectionAreaStyled","useHotkeys","keyup","keydown","onDrop","onDragEnter","onDragOver","tabIndex","hidden","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","render","StrictMode"],"mappings":"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","file":"static/js/main.a62818b8.chunk.js","sourcesContent":["import { createContext, useContext } from 'react'\nimport { IPortRefs, INodeRefs } from '../../types'\n\nexport interface DiagramManager {\n  canvasRef: HTMLDivElement | null\n  portRefs: IPortRefs\n  nodeRefs: INodeRefs\n  scale: number\n}\n\nconst defaultValue: DiagramManager = { canvasRef: null, portRefs: {}, nodeRefs: {}, scale: 1 }\n\nconst DiagramManagerContext = createContext(defaultValue)\n\nexport const DiagramManagerProvider = DiagramManagerContext.Provider\n\n// export DiagramManager Context\nexport const useDiagramManager = (): DiagramManager => {\n  return useContext(DiagramManagerContext)\n}\n\n// export DiagramCanvas Context\nexport const useDiagramCanvas = (): HTMLDivElement | null => {\n  const { canvasRef } = useContext(DiagramManagerContext)\n  return canvasRef\n}\n\n// return  DiagramNod dom 节点\nexport const useDiagramNodeRefs = (): INodeRefs => {\n  const { nodeRefs } = useContext(DiagramManagerContext)\n  return nodeRefs\n}\n\n// return  DiagramNodePorts ports 节点\nexport const usePortRefs = (): IPortRefs => {\n  const { portRefs } = useContext(DiagramManagerContext)\n  return portRefs\n}\n\n// return scale\nexport const useScale = (): number => {\n  const { scale } = useContext(DiagramManagerContext)\n  return scale\n}\n","import React, { useEffect, useMemo, useRef, useState } from 'react'\nimport { DiagramManagerProvider } from '../Context/DiagramManager'\nimport { IPortRefs, INodeRefs, ITransform } from '../../types'\n\ninterface DiagramCanvasProps {\n  portRefs: IPortRefs\n  nodeRefs: INodeRefs\n  transform: ITransform\n}\n\nexport const DiagramCanvas: React.FC<DiagramCanvasProps> = React.memo((props) => {\n  const { children, portRefs, nodeRefs, transform } = props\n  const { scale, translateX, translateY } = transform\n\n  const [canvasDom, setBoundingBox] = useState<HTMLDivElement | null>(null)\n  const canvasRef = useRef<HTMLDivElement>(null)\n\n  // 储存 canvas dom\n  useEffect(() => {\n    setBoundingBox(canvasRef.current)\n  }, [])\n\n  const contextValue = useMemo(\n    () => ({\n      canvasRef: canvasDom,\n      portRefs,\n      nodeRefs,\n      scale,\n    }),\n    [canvasDom, portRefs, nodeRefs, scale]\n  )\n\n  return (\n    <div\n      id=\"diagram-canvas\"\n      className=\"diagram-canvas\"\n      ref={canvasRef}\n      // style={{ transform: `translate(${translate.x}px, ${translate.y}px) scale(${scale})` }}\n      style={{ transform: `matrix(${scale},0,0,${scale},${translateX},${translateY})` }}\n    >\n      <DiagramManagerProvider value={contextValue}>{children}</DiagramManagerProvider>\n    </div>\n  )\n})\n\nDiagramCanvas.displayName = 'DiagramCanvas'\n","import { throttle } from 'lodash-es'\nimport { useRef, useCallback, useEffect } from 'react'\nimport { ICoordinateType } from '../types'\n\nconst DISABLED_DRAG_TAGS = ['INPUT', 'TEXTAREA']\n\ninterface DefaultOptions {\n  ref: React.RefObject<any> | null\n  throttleBy: number\n}\n\ninterface InfoType {\n  isDragging: boolean\n  start: ICoordinateType\n  end: ICoordinateType\n  offset: ICoordinateType\n}\n\nconst defaultOptions: DefaultOptions = {\n  ref: null,\n  throttleBy: 0,\n}\n\nconst getEventCoordinates = (event: MouseEvent): ICoordinateType => [event.clientX, event.clientY]\n\n/**\n * 创建一个持久回调引用\n * @param ref\n * @returns {Function}\n */\nconst CreateCallbackRef = (ref: any) =>\n  useCallback(\n    (callback) => {\n      if (!ref.current || callback !== ref.current) {\n        ref.current = callback\n      }\n    },\n    [ref]\n  )\n\nconst useDrag = (options = defaultOptions) => {\n  const targetRef = options.ref\n  const dragStartHandlerRef = useRef<any>()\n  const dragHandlerRef = useRef<any>()\n  const dragEndHandlerRef = useRef<any>()\n  const { current: info } = useRef<InfoType>({ isDragging: false, start: [0, 0], end: [0, 0], offset: [0, 0] })\n\n  const onDragStart = useCallback(\n    (event) => {\n      const targetTagName = event.target.tagName\n      if (\n        !info.isDragging &&\n        targetRef?.current.contains(event.target) &&\n        !DISABLED_DRAG_TAGS.includes(targetTagName)\n      ) {\n        info.isDragging = true\n        info.end = [0, 0]\n        info.offset = [0, 0]\n        info.start = getEventCoordinates(event)\n\n        if (dragStartHandlerRef.current) {\n          dragStartHandlerRef.current(event, { ...info })\n        }\n      }\n    },\n    [targetRef, info, dragStartHandlerRef]\n  )\n\n  // eslint-disable-next-line\n  const onDrag = useCallback(\n    throttle((event) => {\n      if (info.isDragging) {\n        info.offset = [event.clientX - info.start[0], event.clientY - info.start[1]]\n\n        if (dragHandlerRef.current) {\n          dragHandlerRef.current(event, { ...info })\n        }\n      }\n    }, options.throttleBy),\n    [targetRef, info, dragHandlerRef]\n  )\n\n  const onDragEnd = useCallback(\n    (event) => {\n      if (info.isDragging) {\n        info.isDragging = false\n        info.end = getEventCoordinates(event)\n\n        if (dragEndHandlerRef.current) {\n          dragEndHandlerRef.current(event, { ...info })\n        }\n      }\n    },\n    [info, dragEndHandlerRef]\n  )\n\n  useEffect(() => {\n    const _onDragStart = (e: any) => onDragStart(e)\n    const _onDrag = (e: any) => onDrag(e)\n    const _onDragEnd = (e: any) => onDragEnd(e)\n\n    if (targetRef?.current) {\n      targetRef.current.addEventListener('mousedown', _onDragStart)\n      document.addEventListener('mousemove', _onDrag)\n      document.addEventListener('mouseup', _onDragEnd)\n    }\n\n    return () => {\n      if (targetRef?.current) {\n        // eslint-disable-next-line\n        targetRef.current.removeEventListener('mousedown', _onDragStart)\n        document.removeEventListener('mousemove', _onDrag)\n        document.removeEventListener('mouseup', _onDragEnd)\n      }\n    }\n  }, [targetRef, onDragStart, onDrag, onDragEnd])\n\n  return {\n    ref: targetRef,\n    onDragStart: CreateCallbackRef(dragStartHandlerRef),\n    onDrag: CreateCallbackRef(dragHandlerRef),\n    onDragEnd: CreateCallbackRef(dragEndHandlerRef),\n  }\n}\n\nexport default useDrag\n","import React from 'react'\n\nimport './style.scss'\n\n\nexport interface NodeTypeHeaderProps {\n  icon: React.FC\n  label: string;\n}\n\n\nexport const NodeTypeHeader: React.FC<NodeTypeHeaderProps> = (props) => {\n  const {icon, label} = props\n\n  return (\n    <h4 className='node-header'>\n      {icon && <div className='node-header-icon'>\n        {React.createElement(icon)}\n      </div>}\n      <div className='node-header-text'>{label}</div>\n    </h4>\n  )\n}\n\nNodeTypeHeader.displayName = 'NodeTypeHeader'\n","import React from 'react'\nimport { Input } from 'antd'\n\nimport './style.scss'\nimport { INodeItemProps } from '../../types'\nimport { NodeTypeHeader } from './NodeTypeHeader'\nimport { nodesConfig } from './config'\n\nexport interface NodeTypeInputProps extends INodeItemProps<any> {\n}\n\n\nexport const NodeTypeInput: React.FC<NodeTypeInputProps> = (props) => {\n\n  const {value, onChange} = props\n  const handleInputChange = (e: any) => {\n    onChange({\n      ...value,\n      inputValue: e.target.value\n    })\n  }\n\n  return (\n    <>\n      <NodeTypeHeader icon={nodesConfig.nodeTypeInput.icon} label={nodesConfig.nodeTypeInput.label}/>\n      <Input value={value.inputValue} onChange={handleInputChange} placeholder=\"Basic usage\"/>\n    </>\n  )\n}\n\nNodeTypeInput.displayName = 'NodeTypeInput'\n","import React from 'react'\nimport { Select } from 'antd'\n\nimport './style.scss'\nimport { INodeItemProps } from '../../types'\nimport { NodeTypeHeader } from './NodeTypeHeader'\nimport { nodesConfig } from './config'\n\n\nexport interface NodeTypeSelectProps extends INodeItemProps<any> {\n\n}\n\n\nexport const NodeTypeSelect: React.FC<NodeTypeSelectProps> = ({value, onChange}) => {\n\n  function handleChange(e: string) {\n    onChange({...value, selectValue: e})\n  }\n\n\n  return (\n    <>\n      <NodeTypeHeader icon={nodesConfig.nodeTypeSelect.icon} label={nodesConfig.nodeTypeSelect.label}/>\n      <Select style={{width: 120}} value={value.selectValue} onChange={handleChange}>\n        <Select.Option value=\"jack\">Jack</Select.Option>\n        <Select.Option value=\"lucy\">Lucy</Select.Option>\n        <Select.Option value=\"disabled\" disabled>\n          Disabled\n        </Select.Option>\n        <Select.Option value=\"Yiminghe\">yiminghe</Select.Option>\n      </Select>\n    </>\n  )\n}\n\nNodeTypeSelect.displayName = 'NodeTypeSelect'\n","import React from 'react'\nimport { Button } from 'antd'\n\nimport './style.scss'\nimport { INodeItemProps } from '../../types'\nimport { NodeTypeHeader } from './NodeTypeHeader'\nimport { nodesConfig } from './config'\n\nexport interface NodeTypeButtonProps extends INodeItemProps<any> {\n}\n\nexport const NodeTypeButton: React.FC<NodeTypeButtonProps> = (props) => {\n  const {value} = props\n  // const handleInputChange = (e: any) => {\n  //   onChange({\n  //     ...value,\n  //     inputValue: e.target.value,\n  //   })\n  // }\n\n  return (\n    <>\n      <NodeTypeHeader icon={nodesConfig.nodeTypeButton.icon} label={nodesConfig.nodeTypeButton.label}/>\n      {value.buttonList.map((button: any, index: number) => (\n        <div key={index}>\n          <Button style={{width: '100%'}}>{button.text as string}</Button>\n        </div>\n      ))}\n    </>\n  )\n}\n\nNodeTypeButton.displayName = 'NodeTypeButton'\n","import { NodeTypeInput } from './NodeTypeInput'\nimport { NodeTypeSelect } from './NodeTypeSelect'\nimport { NodeTypeButton } from './NodeTypeButton'\nimport { AppleOutlined, WindowsOutlined, GithubOutlined } from '@ant-design/icons'\nimport { v4 as uuidv4 } from 'uuid'\nimport { ICoordinateType, INodeType, NodeTypeEnum } from '../../types'\nimport { cloneDeep } from 'lodash-es'\n\nexport enum NodeTypes {\n  nodeTypeInput = 'nodeTypeInput',\n  nodeTypeSelect = 'nodeTypeSelect',\n  nodeTypeButton = 'nodeTypeButton'\n}\n\nexport const nodesConfig = {\n  [NodeTypes.nodeTypeInput]: {\n    component: NodeTypeInput,\n    label: 'Input 节点',\n    icon: AppleOutlined\n  },\n  [NodeTypes.nodeTypeSelect]: {\n    component: NodeTypeSelect,\n    label: 'Select 节点',\n    icon: WindowsOutlined\n  },\n  [NodeTypes.nodeTypeButton]: {\n    component: NodeTypeButton,\n    label: 'Button 节点',\n    icon: GithubOutlined\n  }\n}\n\nexport const nodesList = Object.entries(nodesConfig).map(([key, value]) => {\n  return {\n    ...value,\n    type: key\n  }\n})\n\nexport const createNode = (nodeType: NodeTypeEnum, coordinate: ICoordinateType): INodeType => {\n  let nodeData: INodeType = {\n    id: uuidv4(),\n    coordinates: coordinate,\n    type: nodeType,\n    inputs: [],\n    outputs: [],\n    data: {}\n  }\n  switch (nodeType) {\n    case NodeTypes.nodeTypeInput:\n      nodeData = {\n        ...nodeData,\n        outputs: [{id: uuidv4(), isLinked: false}],\n        data: {\n          inputValue: 'test'\n        }\n      }\n\n      break\n    case NodeTypes.nodeTypeSelect:\n      nodeData = {\n        ...nodeData,\n        outputs: [{id: uuidv4(), isLinked: false}],\n        data: {\n          inputValue: ''\n        }\n      }\n      break\n    case NodeTypes.nodeTypeButton:\n      const buttonData = {\n        buttonList: [\n          {text: 'button-1', id: uuidv4()},\n          {text: 'button-2', id: uuidv4()}\n        ]\n      }\n      const outputs = buttonData.buttonList.map((item: any) => ({\n        id: item.id,\n        isLinked: false\n      }))\n      nodeData = {\n        ...nodeData,\n        outputs: outputs,\n        data: buttonData\n      }\n      break\n  }\n\n  return nodeData\n}\n\nconst offsetCoordinates = (coordinates: ICoordinateType, distance = 0): ICoordinateType => [coordinates[0] + distance, coordinates[1] + distance]\n\nexport const copyNode = (originNode: INodeType): INodeType => {\n  const nodeData = cloneDeep(originNode)\n  nodeData.id = uuidv4()\n  nodeData.coordinates = offsetCoordinates(nodeData.coordinates, 20)\n  switch (nodeData.type) {\n    case NodeTypes.nodeTypeInput:\n      nodeData.outputs.forEach((output) => {\n        output.id = uuidv4()\n        output.isLinked = false\n      })\n      break\n    case NodeTypes.nodeTypeSelect:\n      nodeData.outputs.forEach((output) => {\n        output.id = uuidv4()\n        output.isLinked = false\n      })\n      break\n    case NodeTypes.nodeTypeButton:\n      nodeData.data.buttonList.forEach((item: any) => {\n        item.id = uuidv4()\n      })\n      nodeData.outputs = nodeData.data.buttonList.map((item: any) => ({\n        id: item.id,\n        isLinked: false\n      }))\n\n      break\n  }\n\n  return nodeData\n}\n","import { ICoordinateType, IDiagramType, INodeStyle, INodeType } from '../types'\n\n// 计算 鼠标事件 相对在 参照物(diagram 画布)内的坐标\nexport const calculatingCoordinates = (\n  event: MouseEvent,\n  referenceDom: HTMLDivElement | HTMLElement | null,\n  scale: number\n): ICoordinateType => {\n  const referenceDomRect = referenceDom?.getBoundingClientRect() || {x: 0, y: 0}\n  return [(event.clientX - referenceDomRect.x) / scale, (event.clientY - referenceDomRect.y) / scale]\n}\n\nexport const findEventTargetParentNodeId = (dom: HTMLElement | null): null | string => {\n  if (!dom) {\n    return null\n  }\n  const nodeId = dom.id\n  const isNodeDom = dom.classList.contains('diagram-node')\n  if (nodeId && isNodeDom) {\n    return nodeId\n  }\n  if (isNodeDom) {\n    return null\n  }\n  return findEventTargetParentNodeId(dom.parentElement)\n}\n\n// 检测鼠标按下的时候是否是点击在画布空白区域\nexport const checkMouseDownTargetIsDrawPanel = (event: any, panelDom: HTMLElement | null) =>\n  event.target === panelDom || event.target === panelDom?.firstChild\n\n// 碰撞检测 检测两个div 是否相交\nexport const collideCheck = (dom1: HTMLElement | null, dom2: HTMLElement | null) => {\n  if (dom1 && dom2) {\n    const rect1 = dom1.getBoundingClientRect()\n    const rect2 = dom2.getBoundingClientRect()\n    const maxX: number = Math.max(rect1.x + rect1.width, rect2.x + rect2.width)\n    const maxY: number = Math.max(rect1.y + rect1.height, rect2.y + rect2.height)\n    const minX: number = Math.min(rect1.x, rect2.x)\n    const minY: number = Math.min(rect1.y, rect2.y)\n    return maxX - minX <= rect1.width + rect2.width && maxY - minY <= rect1.height + rect2.height\n  }\n  return false\n}\n\nexport const getPathMidpoint = (pathElement: SVGPathElement): ICoordinateType => {\n  if (pathElement.getTotalLength && pathElement.getPointAtLength) {\n    const midpoint = pathElement.getTotalLength() / 2\n    const {x, y} = pathElement.getPointAtLength(midpoint)\n    return [x, y]\n  }\n\n  return [0, 0]\n}\n\nexport const findIndexById = (nodeId: string, nodes: INodeType[]) => nodes.findIndex((node) => node.id === nodeId)\n\nexport const getNodeStyle = (nodeDom: Element): INodeStyle => {\n  const dom = nodeDom as HTMLElement\n  const width = dom.offsetHeight\n  const height = dom.offsetHeight\n  return {\n    width,\n    height,\n    left: dom.offsetLeft,\n    top: dom.offsetTop,\n    right: dom.offsetLeft + width,\n    bottom: dom.offsetTop + height\n  }\n}\n\nexport const batchUpdateCoordinates = (nodeId: string, nextCoordinates: ICoordinateType, nodes: INodeType[], activeNodeIds: string[]): INodeType[] => {\n  const nextNodes = [...nodes]\n\n  const index = findIndexById(nodeId, nextNodes)\n\n  const offsetCoordinate = {\n    xOffset: nextCoordinates[0] - nodes[index].coordinates[0],\n    yOffset: nextCoordinates[1] - nodes[index].coordinates[1]\n  }\n  // update activeNodeIds\n  activeNodeIds.forEach(activeNodeId => {\n    nextNodes.some((node, nextIndex) => {\n      if (node.id === activeNodeId) {\n        nextNodes[nextIndex] = {\n          ...nextNodes[nextIndex],\n          coordinates: [\n            node.coordinates[0] + offsetCoordinate.xOffset,\n            node.coordinates[1] + offsetCoordinate.yOffset\n          ]\n        }\n        return true\n      } else {\n        return false\n      }\n    })\n  })\n  // update self\n  nextNodes[index] = {...nextNodes[index], coordinates: nextCoordinates}\n\n  return nextNodes\n}\n\nexport const oneNodeDelete = (value: IDiagramType, nodeId: string): IDiagramType => {\n  const nextNodes = [...value.nodes]\n  const index = findIndexById(nodeId, nextNodes)\n  const currentNode = value.nodes[index]\n  const nodeOutputs = currentNode.outputs.map((port) => port.id)\n  const nodeInputs = currentNode.inputs.map((port) => port.id)\n  nextNodes.splice(index, 1)\n  // 删除和节点相关的所有线\n  let nextLinks = value.links.filter((link) => {\n    return (\n      !nodeInputs.includes(link.output) &&\n      !nodeOutputs.includes(link.input) &&\n      link.input !== nodeId &&\n      link.output !== nodeId\n    )\n  })\n  return {links: nextLinks, nodes: nextNodes}\n}\n\nexport const checkIsFocusInPanel = (panelDom: HTMLElement | null) => document.activeElement === panelDom\n","import React, { useEffect, useRef } from 'react'\nimport useDrag from '../../hooks/useDrag'\nimport { ICoordinateType, IPointType } from '../../types'\nimport { calculatingCoordinates, findEventTargetParentNodeId } from '../../utils'\nimport { useDiagramCanvas, useScale } from '../Context/DiagramManager'\nimport classnames from 'classnames'\n\ninterface PortProps extends IPointType {\n  nodeId: string\n  type: 'input' | 'output'\n  index: number\n  onDragNewSegment: (id: string, from: ICoordinateType, to: ICoordinateType) => void\n  onSegmentFail: (id: string, type: string) => void\n  onSegmentConnect: (id: string, targetPort: string) => void\n  onShowSelectModel: (event: MouseEvent, input: string) => void\n  onPortMount: (id: string, dom: HTMLElement) => void\n}\n\nexport const Port: React.FC<PortProps> = React.memo((props) => {\n  const {\n    id,\n    isLinked,\n    index,\n    nodeId,\n    onDragNewSegment,\n    onSegmentFail,\n    onSegmentConnect,\n    onShowSelectModel,\n    onPortMount,\n    type,\n  } = props\n  const canvasRef = useDiagramCanvas()\n  const scale = useScale()\n  const ref: any = useRef<React.RefObject<HTMLElement>>(null)\n  const startCoordinatesRef = useRef<ICoordinateType | undefined>()\n\n  const className = classnames('diagram-port', {\n    'type-input': type === 'input',\n    'type-output': type === 'output',\n    'is-linked': isLinked,\n  })\n\n  const { onDragStart, onDrag, onDragEnd } = useDrag({ ref, throttleBy: 15 })\n\n  onDragStart((event: MouseEvent) => {\n    event.stopImmediatePropagation()\n    event.stopPropagation()\n    if (canvasRef && ref.current) {\n      const { x: canvasX, y: canvasY } = canvasRef.getBoundingClientRect()\n      const { x, y, width, height } = ref.current.getBoundingClientRect()\n      startCoordinatesRef.current = [(x - canvasX + width / 2) / scale, (y - canvasY + height / 2) / scale]\n    }\n  })\n\n  onDrag((event: MouseEvent) => {\n    if (startCoordinatesRef.current) {\n      event.stopImmediatePropagation()\n      event.stopPropagation()\n      const to: ICoordinateType = calculatingCoordinates(event, canvasRef, scale)\n\n      onDragNewSegment(id, startCoordinatesRef.current, to)\n    }\n  })\n\n  onDragEnd((event: MouseEvent) => {\n    const targetDom = event.target as HTMLElement\n    const targetIsPort = targetDom.classList.contains('diagram-port')\n    // 如果目标元素是 port 区域 并且不是起点port\n    if (targetIsPort && targetDom.id !== id) {\n      onSegmentConnect(id, targetDom.id)\n      return\n    }\n\n    // 如果目标元素是 node 区域 并非不是起点node\n    const targetNode = findEventTargetParentNodeId(event.target as HTMLElement)\n    if (targetNode && targetNode !== nodeId) {\n      onSegmentConnect(id, targetNode)\n      return\n    }\n    const panelDom = document.getElementById('diagram-panel')\n    if (panelDom && panelDom.contains(event.target as HTMLElement)) {\n      onShowSelectModel(event, id)\n    }\n    // 否则在空白区域松开 释放\n    onSegmentFail && onSegmentFail(id, type)\n  })\n\n  useEffect(() => {\n    onPortMount(id, ref.current)\n  }, [id, onPortMount])\n\n  return (\n    <div className={className} id={id} ref={ref} style={{ top: index === 0 ? '45%' : `calc(45% + ${index * 18}px)` }} />\n  )\n})\n","import React from 'react'\nimport { ICoordinateType, IPointType } from '../../types'\nimport { Port } from './Port'\n\nexport interface DiagramNodePortsProps {\n  inputs: IPointType[]\n  nodeId: string\n  type: 'input' | 'output'\n  onPortMount: (id: string, dom: HTMLElement) => void\n  onDragNewSegment: (id: string, from: ICoordinateType, to: ICoordinateType) => void\n  onSegmentFail: (id: string, type: string) => void\n  onSegmentConnect: (id: string, targetPort: string) => void\n  onShowSelectModel: (event: MouseEvent, input: string) => void\n}\n\nexport const DiagramNodePorts: React.FC<DiagramNodePortsProps> = (props) => {\n  const {\n    inputs,\n    onPortMount,\n    onDragNewSegment,\n    onSegmentFail,\n    onSegmentConnect,\n    onShowSelectModel,\n    nodeId,\n    type,\n  } = props\n  return (\n    <>\n      {inputs.map((port, index) => (\n        <Port\n          onPortMount={onPortMount}\n          onDragNewSegment={onDragNewSegment}\n          onSegmentFail={onSegmentFail}\n          onShowSelectModel={onShowSelectModel}\n          onSegmentConnect={onSegmentConnect}\n          type={type}\n          key={port.id}\n          id={port.id}\n          index={index}\n          isLinked={port.isLinked}\n          nodeId={nodeId}\n        />\n      ))}\n    </>\n  )\n}\n\nDiagramNodePorts.displayName = 'DiagramNodePorts'\n","import React, { useCallback } from 'react'\nimport { Button } from 'antd'\nimport { DeleteOutlined, CopyOutlined } from '@ant-design/icons'\n\n\n// import { DeleteOutlined } from '@ant-design/icons'\n\n\nexport interface DiagramNodeActionButtonsProps {\n  id: string\n  onNodeCopy: (nodeId: string) => void\n  onNodeDelete: (nodeId: string) => void\n}\n\nexport const DiagramNodeActionButtons: React.FC<DiagramNodeActionButtonsProps> = (props) => {\n  const {onNodeDelete, onNodeCopy, id} = props\n\n  const handleNodeDelete = useCallback(() => {\n    onNodeDelete(id)\n  }, [id, onNodeDelete])\n\n  const handleNodeCopy = useCallback(() => {\n    onNodeCopy(id)\n  }, [id, onNodeCopy])\n\n  return (\n    <div className='diagram-node-action'>\n      <Button onClick={handleNodeCopy} icon={<CopyOutlined/>}/>\n      <Button onClick={handleNodeDelete} icon={<DeleteOutlined/>}/>\n    </div>\n  )\n}\n\nDiagramNodeActionButtons.displayName = 'DiagramNodeActionButtons'\n","export interface Listener {\n  cb: Function\n  once: boolean\n}\n\nexport interface EventsType {\n  [eventName: string]: Listener[]\n}\n\n/**\n * const ee = new OnFire();\n *\n * ee.on('click', (...values) => {});\n *\n * ee.on('mouseover', (...values) => {});\n *\n * ee.emit('click', 1, 2, 3);\n * ee.fire('mouseover', {}); // same with emit\n *\n * ee.off();\n */\nexport default class OnFire {\n  static ver = '__VERSION__'\n\n  // 所有事件的监听器\n  es: EventsType = {}\n\n  on(eventName: string, cb: Function, once: boolean = false) {\n    if (!this.es[eventName]) {\n      this.es[eventName] = []\n    }\n\n    this.es[eventName].push({\n      cb,\n      once,\n    })\n  }\n\n  once(eventName: string, cb: Function) {\n    this.on(eventName, cb, true)\n  }\n\n  fire(eventName: string, ...params: any[]) {\n    const listeners = this.es[eventName] || []\n\n    let l = listeners.length\n\n    for (let i = 0; i < l; i++) {\n      const { cb, once } = listeners[i]\n\n      cb.apply(this, params)\n\n      if (once) {\n        listeners.splice(i, 1)\n        i--\n        l--\n      }\n    }\n  }\n\n  off(eventName?: string, cb?: Function) {\n    // clean all\n    if (eventName === undefined) {\n      this.es = {}\n    } else {\n      if (cb === undefined) {\n        // clean the eventName's listeners\n        delete this.es[eventName]\n      } else {\n        const listeners = this.es[eventName] || []\n        // clean the event and listener\n        let l = listeners.length\n        for (let i = 0; i < l; i++) {\n          if (listeners[i].cb === cb) {\n            listeners.splice(i, 1)\n            i--\n            l--\n          }\n        }\n      }\n    }\n  }\n\n  // cname of fire\n  emit(eventName: string, ...params: any[]) {\n    this.fire(eventName, ...params)\n  }\n}\n","import EE from './onfire'\n\nexport const EVENT_NODE_MOVING = 'NODE_MOVING'\nexport const EVENT_NODE_MOVE_END = 'NODE_MOVE_END'\n\nexport const EVENT_AUTO_LAYOUT = 'AUTO_LAYOUT'\n\nexport default new EE()\n","import React, { useCallback, useEffect, useMemo, useRef } from 'react'\nimport useDrag from '../../hooks/useDrag'\nimport { INodeType, ICoordinateType } from '../../types'\nimport { nodesConfig } from '../NodeTypes/config'\nimport { isEqual } from 'lodash-es'\nimport { useScale } from '../Context/DiagramManager'\nimport { DiagramNodePorts } from './DiagramNodePorts'\nimport classnames from 'classnames'\nimport { DiagramNodeActionButtons } from './DiagramNodeActionButtons'\nimport eventBus, { EVENT_NODE_MOVE_END, EVENT_NODE_MOVING } from '../../utils/eventBus'\n\ninterface DiagramNodeProps {\n  nodeInfo: INodeType\n  onNodePositionChange: (id: string, nextCoords: ICoordinateType) => void\n  onNodeValueChange: (id: string, nextNodeValue: any) => void\n  onAddHistory: (id: string, nextCoords: ICoordinateType) => void\n  onNodeMount: (id: string, dom: HTMLDivElement) => void\n  onPortMount: (id: string, dom: HTMLElement) => void\n  onDragNewSegment: (id: string, from: ICoordinateType, to: ICoordinateType) => void\n  onSegmentFail: (id: string, type: string) => void\n  onSegmentConnect: (id: string, targetPort: string) => void\n  onShowSelectModel: (event: MouseEvent, input: string) => void\n  onNodeDelete: (nodeId: string) => void\n  onNodeCopy: (nodeId: string) => void\n  onToggleActiveNodeId: (nodeId: string) => void\n  isActive: boolean\n}\n\nexport const DiagramNode: React.FC<DiagramNodeProps> = React.memo((props) => {\n  const {\n    nodeInfo,\n    onNodeValueChange,\n    onNodePositionChange,\n    onPortMount,\n    onDragNewSegment,\n    onNodeMount,\n    onSegmentFail,\n    onSegmentConnect,\n    onShowSelectModel,\n    onAddHistory,\n    onToggleActiveNodeId,\n    isActive,\n    onNodeDelete,\n    onNodeCopy\n  } = props\n\n  const {id, coordinates, type, inputs, data, outputs} = nodeInfo\n\n  const scale = useScale()\n\n  // nodeType\n  const component = nodesConfig[type]?.component\n\n  const handleNodeDataChange = (nextNodeData: any) => {\n    onNodeValueChange(id, nextNodeData)\n  }\n\n  // 传给子组件点 Props\n  const nodeItemProps = {\n    value: data,\n    onChange: handleNodeDataChange\n  }\n\n  const ref: any = useRef(null)\n\n  const {onDragStart, onDrag, onDragEnd} = useDrag({throttleBy: 14, ref}) // get the drag n drop methods\n  const dragStartPoint = useRef(coordinates) // keeps the drag start point in a persistent reference\n\n  // when drag starts, save the starting coordinates into the `dragStartPoint` ref\n  onDragStart(() => {\n    dragStartPoint.current = coordinates\n  })\n\n  // whilst dragging calculates the next coordinates and perform the `onNodePositionChange` callback\n  onDrag((event: MouseEvent, info: any) => {\n    event.stopImmediatePropagation()\n    event.stopPropagation()\n    const nextCoords: ICoordinateType = [\n      dragStartPoint.current[0] + info.offset[0] / scale,\n      dragStartPoint.current[1] + info.offset[1] / scale\n    ]\n\n    onNodePositionChange(id, nextCoords)\n    eventBus.emit(EVENT_NODE_MOVING, id, nextCoords)\n  })\n\n  onDragEnd((event: MouseEvent) => {\n    if (!isEqual(dragStartPoint.current, coordinates)) {\n      onAddHistory(id, dragStartPoint.current)\n    }\n    eventBus.emit(EVENT_NODE_MOVE_END)\n  })\n\n  const handleClick = useCallback((event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (event.shiftKey) {\n      onToggleActiveNodeId(id)\n    }\n  }, [id, onToggleActiveNodeId])\n\n  const options = {nodeId: id, onPortMount, onDragNewSegment, onSegmentFail, onSegmentConnect, onShowSelectModel}\n\n  useEffect(() => {\n    onNodeMount(id, ref.current)\n  }, [id, onNodeMount])\n\n  const className = useMemo(() => {\n    return classnames('diagram-node', {\n      active: isActive\n    })\n  }, [isActive])\n\n  return (\n    <div\n      id={id}\n      className={className}\n      ref={ref}\n      style={{left: coordinates[0], top: coordinates[1]}}\n      onClick={handleClick}>\n      {component && React.createElement(component, nodeItemProps)}\n      <DiagramNodePorts inputs={inputs} {...options} type=\"input\"/>\n      <DiagramNodePorts inputs={outputs} {...options} type=\"output\"/>\n      <DiagramNodeActionButtons id={id} onNodeDelete={onNodeDelete} onNodeCopy={onNodeCopy}/>\n    </div>\n  )\n})\n\nDiagramNode.displayName = 'DiagramNode'\n","import React from 'react'\nimport { DiagramNode } from './DiagramNode'\nimport { ICoordinateType, INodeType } from '../../types'\n\ninterface NodesCanvasProps {\n  nodes: INodeType[]\n  onNodeMount: (id: string, dom: HTMLDivElement) => void\n  onPortMount: (id: string, dom: HTMLElement) => void\n  onDragNewSegment: (id: string, from: ICoordinateType, to: ICoordinateType) => void\n  onSegmentFail: (id: string, type: string) => void\n  onSegmentConnect: (id: string, targetPort: string) => void\n  onShowSelectModel: (event: MouseEvent, input: string) => void\n  activeNodeIds: string[]\n  onNodePositionChange: (id: string, nextCoords: ICoordinateType) => void\n  onNodeValueChange: (id: string, nextNodeValue: any) => void\n  onAddHistory: (id: string, nextCoords: ICoordinateType) => void\n  onNodeDelete: (nodeId: string) => void\n  onNodeCopy: (nodeId: string) => void\n  onToggleActiveNodeId: (nodeId: string) => void\n}\n\nexport const NodesCanvas: React.FC<NodesCanvasProps> = React.memo((props) => {\n  const {nodes, activeNodeIds, ...others} = props\n\n  return (\n    <>\n      {nodes.map((node) => (\n        <DiagramNode isActive={activeNodeIds.includes(node.id)} nodeInfo={node} key={node.id} {...others} />\n      ))}\n    </>\n  )\n})\n\nNodesCanvas.displayName = 'NodesCanvas'\n","import { ICoordinateType } from '../types'\n\nconst roundPoint = (point: ICoordinateType): ICoordinateType => [Math.floor(point[0]), Math.floor(point[1])]\n\n// 贝塞尔曲线算法\nconst makeBezierCurve = (from: ICoordinateType, to: ICoordinateType) => {\n  if (to[0] >= from[0]) {\n    return getCubicBezierPath(from, to)\n  } else {\n    return getAdvancedCubicBezierPath(from, to)\n  }\n}\n\nconst getPointsString = (points: ICoordinateType[]) => {\n  return points.map((item) => `${item[0]},${item[1]}`).join(' ')\n}\n\n// 正向 贝塞尔曲线\nconst getCubicBezierPath = (from: ICoordinateType, to: ICoordinateType) => {\n  const controlPointForStart: ICoordinateType = [(to[0] + from[0]) / 2, from[1]]\n  const controlPointForEnd: ICoordinateType = [(to[0] + from[0]) / 2, to[1]]\n\n  return `M ${from[0]},${from[1]} C ${getPointsString([controlPointForStart, controlPointForEnd])} ${to[0]},${to[1]}`\n}\n\n// 反向 贝塞尔曲线\nconst getAdvancedCubicBezierPath = (from: ICoordinateType, to: ICoordinateType) => {\n  const midX = (from[0] + to[0]) / 2\n  const midY = (from[1] + to[1]) / 2\n\n  return `M${from[0]},${from[1]} ${from[0] + 20},${from[1]} C ${from[0] + 100},${from[1]} ${from[0] + 130},${\n    (midY + from[1]) / 2\n  }  ${midX},${midY} C ${midX},${midY} ${to[0] - 130},${(midY + to[1]) / 2} ${to[0] - 2},${to[1]} M ${to[0] - 2},${\n    to[1]\n  } ${to[0]},${to[1]}`\n}\n\n/**\n * 生成连点之间的贝塞尔曲线\n */\nconst makeSvgPath = (startPoint?: ICoordinateType, endPoint?: ICoordinateType) => {\n  if (!startPoint || !endPoint) return ''\n  const roundedStart = roundPoint(startPoint)\n  const roundedEnd = roundPoint(endPoint)\n\n  // const start = `${roundedStart[0]}, ${roundedStart[1]}`\n  // const end = `${roundedEnd[0]}, ${roundedEnd[1]}`\n\n  // 生成 直线\n  // return `M ${start}, ${end}`\n\n  // 生成 曲线\n  return makeBezierCurve(roundedStart, roundedEnd)\n}\n\nexport default makeSvgPath\n","import React from 'react'\nimport { ICoordinateType } from '../../types'\nimport { DeleteOutlined } from '@ant-design/icons'\n\ninterface LinkDeleteProps {\n  position: ICoordinateType\n  onDelete: () => void\n}\n\n\nexport const LinkDelete: React.FC<LinkDeleteProps> = React.memo(({position, onDelete}) => (\n  <foreignObject x={position[0]} y={position[1]}>\n    <div className=\"bi-diagram-link-label\">\n      <DeleteOutlined onClick={onDelete}/>\n    </div>\n  </foreignObject>\n))\n\nLinkDelete.displayName = 'LinkDelete'\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport makeSvgPath from '../../utils/makeSvgPath'\nimport { LinkDelete } from './LinkDelete'\nimport { ICoordinateType, ILinkType } from '../../types'\nimport { getPathMidpoint } from '../../utils'\nimport { isEqual } from 'lodash-es'\n\ninterface LinkProps {\n  input: ICoordinateType\n  output: ICoordinateType\n  link: ILinkType\n  onDelete: (link: ILinkType) => void\n}\n\nexport const Link: React.FC<LinkProps> = React.memo(\n  (props) => {\n    const { input, output, link, onDelete } = props\n    const pathRef = useRef<SVGPathElement>(null)\n    const [labelPosition, setLabelPosition] = useState<ICoordinateType>()\n\n    /*\n     * 根据亮点坐标生成 svg path 路径\n     * */\n    const path = useMemo(() => makeSvgPath(input, output), [input, output])\n\n    useEffect(() => {\n      if (pathRef.current) {\n        setLabelPosition(getPathMidpoint(pathRef.current))\n      }\n    }, [pathRef, input, output])\n\n    const handleDelete = useCallback(() => {\n      onDelete(link)\n    }, [onDelete, link])\n\n    return (\n      <g className={'diagram-link'}>\n        <path d={path} className=\"bi-link-ghost\" />\n        <path d={path} ref={pathRef} className=\"bi-link-path\" />\n        {labelPosition && <LinkDelete position={labelPosition} onDelete={handleDelete} />}\n      </g>\n    )\n  },\n  (prev, next) => {\n    /*\n     *  memo 默认是浅比较 只比较 props 第一层\n     *  由于 props 上面 的 input output 等属性在外层每次会重新创建 导致浅层 比较地址 永远等于 false ，使得组件每次都会render 导致memo无效\n     * 所以使用 isEqual 进行值的比较 进行优化\n     */\n    return isEqual(prev, next)\n  }\n)\n\nLink.displayName = 'Link'\n","import React, { useMemo } from 'react'\nimport { Link } from './Link'\nimport { ILinkType, INodeType, ICoordinateType, IPortRefs, INodeRefs, IPointType } from '../../types'\nimport { useDiagramManager } from '../Context/DiagramManager'\n\ninterface LinkCanvasProps {\n  nodes: INodeType[]\n  links: ILinkType[]\n  onDelete: (link: ILinkType) => void\n}\n\n/*\n * link 起点终点 数据类型\n * */\nexport interface EntityPutType {\n  startCoordinates: ICoordinateType\n  endCoordinates: ICoordinateType\n  link: ILinkType\n}\n\nconst findPortCoordinate = (\n  nodeCoordinates: ICoordinateType,\n  ports: IPointType[],\n  entityId: string,\n  portRefs: IPortRefs\n): ICoordinateType | null => {\n  for (let j = 0; j < ports.length; j++) {\n    const input = ports[j]\n    if (input.id === entityId) {\n      const portDom = portRefs[entityId]\n      if (!portDom) return null\n      return [\n        nodeCoordinates[0] + portDom.offsetLeft + portDom.offsetWidth / 2,\n        nodeCoordinates[1] + portDom.offsetTop + portDom.offsetHeight / 2,\n      ]\n    }\n  }\n  return null\n}\n\n/*\n * 计算 link 起点终点坐标\n * 1. 如果找到 id 是 node 类型线，实际坐标为 x 为该 node 的 left 值，y坐标为该node 的 top + node高度的一半\n * 2. 如果找到 id 是 port 类型线，实际坐标为 x 为该 port 的 父元素 node 的 left + 点相对 node 的偏移量 +点的宽度的一半，y 轴坐标同理\n * */\nconst computedLinkCoordinate = (\n  nodes: INodeType[],\n  entityId: string,\n  nodeRefs: INodeRefs,\n  portRefs: IPortRefs,\n  canvasRef: HTMLDivElement | null\n): ICoordinateType | null => {\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i]\n    // 如果 id 是 nodeId\n    if (node.id === entityId) {\n      const nodeEl = nodeRefs[entityId]\n      if (!nodeEl) return null\n      return [node.coordinates[0], node.coordinates[1] + nodeEl.offsetHeight / 2]\n    } else {\n      const inputRes = findPortCoordinate(node.coordinates, node.inputs, entityId, portRefs)\n      if (inputRes) return inputRes\n\n      const outputRes = findPortCoordinate(node.coordinates, node.outputs, entityId, portRefs)\n      if (outputRes) return outputRes\n    }\n  }\n  return null\n}\n\nexport const LinksCanvas: React.FC<LinkCanvasProps> = React.memo((props) => {\n  const { nodes, onDelete, links } = props\n\n  const { canvasRef, portRefs, nodeRefs } = useDiagramManager()\n\n  const result = useMemo(() => {\n    const res: EntityPutType[] = []\n\n    links.forEach((link) => {\n      const { input, output } = link\n      const startCoordinates = computedLinkCoordinate(nodes, input, nodeRefs, portRefs, canvasRef)\n      const endCoordinates = computedLinkCoordinate(nodes, output, nodeRefs, portRefs, canvasRef)\n      if (startCoordinates && endCoordinates) {\n        res.push({\n          link,\n          startCoordinates,\n          endCoordinates,\n        })\n      }\n    })\n    return res\n  }, [nodes, links, nodeRefs, portRefs, canvasRef])\n\n  return (\n    <svg className=\"diagram-link-canvas\">\n      {result.map((item) => (\n        <Link\n          link={item.link}\n          input={item.startCoordinates}\n          output={item.endCoordinates}\n          onDelete={onDelete}\n          key={`${item.link.input}-${item.link.output}`}\n        />\n      ))}\n    </svg>\n  )\n})\nLinksCanvas.displayName = 'LinksCanvas'\n","import React, { useMemo } from 'react'\nimport makeSvgPath from '../../utils/makeSvgPath'\nimport { ISegmentType } from '../../types'\n\nexport interface SegmentProps {\n  segment: ISegmentType\n}\n\nexport const Segment: React.FC<SegmentProps> = React.memo(({segment}) => {\n  const {from, to, id} = segment\n  const path = useMemo(() => makeSvgPath(from, to), [from, to])\n\n  return (\n    <svg className=\"diagram-segment-canvas\">\n      <g className=\"diagram-segment-link\" id={id}>\n        <path d={path}/>\n        <circle r=\"5\" cx={to[0]} cy={to[1]}/>\n      </g>\n    </svg>\n  )\n})\n\nSegment.displayName = 'Segment'\n\n\n","import { useLayoutEffect, useMemo, useRef } from 'react'\n\ntype Fn<ARGS extends any[], R> = (...args: ARGS) => R\nconst useEventCallback = <A extends any[], R>(fn: Fn<A, R>): Fn<A, R> => {\n  let ref = useRef(fn)\n  useLayoutEffect(() => {\n    ref.current = fn\n  })\n  return useMemo(\n    () => (...args) => {\n      const { current } = ref\n      return current(...args)\n    },\n    []\n  )\n}\nexport default useEventCallback\n","import { useEffect } from 'react'\nimport eventBus from '../utils/eventBus'\n\ninterface UseEventType {\n  type: string\n  onChange: any\n}\nconst useEventBus = ({ type, onChange }: UseEventType, dep = []) => {\n  useEffect(() => {\n    eventBus.on(type, onChange)\n    return () => {\n      eventBus.off(type, onChange)\n    }\n  }, [type, onChange, ...dep])\n}\nexport default useEventBus\n","import { isEqual } from 'lodash-es'\nimport React, { useCallback, useEffect, useRef } from 'react'\nimport useEventBus from '../../hooks/useEventBus'\nimport { ICoordinateType } from '../../types'\nimport eventBus, { EVENT_NODE_MOVE_END, EVENT_NODE_MOVING } from '../../utils/eventBus'\n\nexport interface MarkLineProps {\n  onNodePositionChange: (id: string, nextCoords: ICoordinateType) => void\n}\n\nconst getNodeStyle = (nodeDom: any) => {\n  const dom = nodeDom as HTMLElement\n  const width = dom.offsetWidth\n  const height = dom.offsetHeight\n  return {\n    width,\n    height,\n    left: dom.offsetLeft,\n    top: dom.offsetTop,\n    right: dom.offsetLeft + width,\n    bottom: dom.offsetTop + height,\n  }\n}\n\nconst DIFF = 3\nconst isNearly = (dragValue: number, targetValue: number) => Math.abs(dragValue - targetValue) <= DIFF\n\nexport const MarkLine: React.FC<MarkLineProps> = React.memo(({ onNodePositionChange }) => {\n  const ref = useRef<HTMLDivElement>(null)\n\n  const handleHideLine = useCallback(() => {\n    if (ref.current) {\n      ref.current.childNodes.forEach((markLine) => {\n        const line = markLine as HTMLElement\n        if (line.style.visibility === 'visible') {\n          line.style.visibility = 'hidden'\n        }\n      })\n    }\n  }, [ref])\n\n  const handleMove = useCallback(\n    (nodeId: string, coordinates: ICoordinateType) => {\n      handleHideLine()\n\n      const curNodeDom = document.getElementById(nodeId)\n      if (!curNodeDom) return\n\n      const curNodeStyle = getNodeStyle(curNodeDom)\n\n      const nodes = Array.from(document.querySelectorAll('.diagram-node'))\n      nodes.forEach((node) => {\n        if (nodeId !== node.id) {\n          const nodeStyle = getNodeStyle(node)\n          const { top, left, bottom, right } = nodeStyle\n          const conditions: any = {\n            top: [\n              {\n                isNearly: isNearly(curNodeStyle.top, top),\n                lineNode: ref.current?.childNodes[0],\n                line: 'x-top',\n                dragShift: top,\n                lineShift: top,\n              },\n              {\n                isNearly: isNearly(curNodeStyle.bottom, top),\n                lineNode: ref.current?.childNodes[0],\n                line: 'x-top',\n                dragShift: top - curNodeStyle.height,\n                lineShift: top,\n              },\n              {\n                isNearly: isNearly(curNodeStyle.top, bottom),\n                lineNode: ref.current?.childNodes[1],\n                line: 'x-bottom',\n                dragShift: bottom,\n                lineShift: bottom,\n              },\n              {\n                isNearly: isNearly(curNodeStyle.bottom, bottom),\n                lineNode: ref.current?.childNodes[1],\n                line: 'x-bottom',\n                dragShift: bottom - curNodeStyle.height,\n                lineShift: bottom,\n              },\n            ],\n            left: [\n              {\n                isNearly: isNearly(curNodeStyle.left, left),\n                lineNode: ref.current?.childNodes[2],\n                line: 'y-left',\n                dragShift: left,\n                lineShift: left,\n              },\n              {\n                isNearly: isNearly(curNodeStyle.right, left),\n                lineNode: ref.current?.childNodes[2],\n                line: 'y-left',\n                dragShift: left - curNodeStyle.width,\n                lineShift: left,\n              },\n              {\n                isNearly: isNearly(curNodeStyle.left, right),\n                lineNode: ref.current?.childNodes[3],\n                line: 'y-right',\n                dragShift: right,\n                lineShift: right,\n              },\n              {\n                isNearly: isNearly(curNodeStyle.right, right),\n                lineNode: ref.current?.childNodes[3],\n                line: 'y-right',\n                dragShift: right - curNodeStyle.width,\n                lineShift: right,\n              },\n            ],\n          }\n\n          Object.keys(conditions).forEach((key: string) => {\n            conditions[key].forEach((condition: any) => {\n              if (condition.isNearly) {\n                if (condition.lineNode) {\n                  condition.lineNode.style[key] = `${condition.lineShift}px`\n                  condition.lineNode.style.visibility = 'visible'\n                }\n                let newCoordinates: ICoordinateType = [...coordinates]\n                if (key === 'top') {\n                  newCoordinates = [coordinates[0], condition.dragShift]\n                } else {\n                  newCoordinates = [condition.dragShift, coordinates[1]]\n                }\n\n                if (!isEqual(newCoordinates, coordinates)) {\n                  onNodePositionChange(nodeId, newCoordinates)\n                }\n              }\n            })\n          })\n        }\n      })\n    },\n    [handleHideLine, onNodePositionChange]\n  )\n\n  useEventBus({ type: EVENT_NODE_MOVING, onChange: handleMove })\n  useEventBus({ type: EVENT_NODE_MOVE_END, onChange: handleHideLine })\n\n  return (\n    <div className=\"mark-line\" ref={ref}>\n      <div className=\"mark-line-item x-direction\" data-mark-line-id=\"x-top\" />\n      <div className=\"mark-line-item x-direction\" data-mark-line-id=\"x-bottom\" />\n      <div className=\"mark-line-item y-direction\" data-mark-line-id=\"y-left\" />\n      <div className=\"mark-line-item y-direction\" data-mark-line-id=\"y-right\" />\n    </div>\n  )\n})\n\nMarkLine.displayName = 'MarkLine'\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { ICoordinateType, NodeTypeEnum } from '../../types'\nimport { nodesList } from '../NodeTypes/config'\n\nexport interface SelectModelProps {\n  position?: ICoordinateType\n  onChange: (nodeType?: NodeTypeEnum) => void\n}\n\nexport const SelectModel: React.FC<SelectModelProps> = React.memo((prop) => {\n  const { position, onChange } = prop\n\n  if (!position) {\n    return null\n  }\n\n  const handleClose = () => {\n    onChange()\n  }\n\n  const handleItemClick = (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => {\n    onChange(event.currentTarget.dataset.type as NodeTypeEnum)\n  }\n  const stopEvent = (event: React.MouseEvent<HTMLUListElement, MouseEvent>) => {\n    event.stopPropagation()\n  }\n\n  return ReactDOM.createPortal(\n    <div className=\"select-model\" onClick={handleClose}>\n      <ul\n        className=\"select-model-content\"\n        style={{ left: position[0], top: position[1], position: 'absolute' }}\n        onClick={stopEvent}\n      >\n        {nodesList.map((node) => (\n          <li key={node.type} className=\"select-model-item\" onClick={handleItemClick} data-type={node.type}>\n            {node.icon && React.createElement(node.icon)}\n            <div className=\"select-model-text\">{node.label}</div>\n          </li>\n        ))}\n      </ul>\n    </div>,\n    document.body\n  )\n})\n\nSelectModel.displayName = 'SelectModel'\n","import { groupBy, maxBy, omit } from 'lodash-es'\nimport { getNodeStyle } from '.'\nimport { IDiagramType, ILinkType, INodeRefs, INodeStyle, INodeType, IPointType } from '../types'\n\nconst checkPortIsNodeSon = (ports: IPointType[], entityId: string) => {\n  for (let j = 0; j < ports.length; j++) {\n    const input = ports[j]\n    if (input.id === entityId) {\n      return true\n    }\n  }\n  return false\n}\n\nconst findPortFatherNodeId = (entityId: string, nodes: INodeType[]) => {\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i]\n    // 如果 id 是 nodeId\n    if (node.id === entityId) {\n      return node.id\n    } else {\n      if (checkPortIsNodeSon(node.inputs, entityId)) return node.id\n      if (checkPortIsNodeSon(node.outputs, entityId)) return node.id\n    }\n  }\n  return entityId\n}\n\nconst checkIsStartLink = (linkInput: string, links: ILinkType[], nodes: INodeType[]) =>\n  !links.find((link) => link.output === findPortFatherNodeId(linkInput, nodes))\n\ninterface ExtendActionDto extends INodeType {\n  row: number\n  column: number\n  style: INodeStyle\n}\n\nconst recursionLookup = (\n  linkEndId: string,\n  baseColumn: number,\n  row: number,\n  extendNodes: ExtendActionDto[],\n  links: ILinkType[],\n  catchNodeIds: string[]\n) => {\n  if (catchNodeIds.includes(linkEndId)) return\n  catchNodeIds.push(linkEndId)\n  const nodeIndex = extendNodes.findIndex((node) => node.id === findPortFatherNodeId(linkEndId, extendNodes))\n  extendNodes[nodeIndex].row = row\n  extendNodes[nodeIndex].column = baseColumn\n  baseColumn++\n\n  extendNodes[nodeIndex].outputs.forEach((port) => {\n    const findLink = links.find((link) => link.input === port.id)\n\n    if (findLink) {\n      recursionLookup(findLink.output, baseColumn, row, extendNodes, links, catchNodeIds)\n    }\n  })\n}\n/*\n * 自动排列 需要根据实际的点和线 连接放松排列 这里的自动排列涵盖情况有限 重新排列效果仅供参考\n */\nexport default function autoLayout(value: IDiagramType, nodeRefs: INodeRefs) {\n  const { links = [], nodes = [] } = value\n  let row = 1\n  const extendNodes = nodes.map((node) => {\n    return {\n      ...node,\n      row: 0,\n      column: 0,\n      style: getNodeStyle(nodeRefs[node.id]),\n    }\n  })\n\n  links.forEach((link) => {\n    if (checkIsStartLink(link.input, links, extendNodes)) {\n      const portFatherNodeId = findPortFatherNodeId(link.input, extendNodes)\n      const catchNodeIds = [portFatherNodeId]\n      const nodeIndex = extendNodes.findIndex((node) => node.id === portFatherNodeId)\n      extendNodes[nodeIndex].row = extendNodes[nodeIndex].row || row\n      extendNodes[nodeIndex].column = 1\n      recursionLookup(link.output, 2, row, extendNodes, links, catchNodeIds)\n      row++\n    }\n  })\n\n  // if is init data update row and column\n  extendNodes.forEach((node) => {\n    if (node.row === 0) {\n      node.row = row\n      node.column = 1\n      row++\n    }\n  })\n\n  const extendNodesCopy = [...extendNodes]\n  extendNodesCopy.forEach(({ outputs }) => {\n    const nextNodeIds: string[] = []\n    outputs.forEach((port) => {\n      if (port.isLinked) {\n        const findLink = links.find((link) => link.input === port.id)\n        if (findLink) {\n          nextNodeIds.push(findLink.output)\n        }\n      }\n    })\n    extendNodes.sort((a, b) => {\n      return nextNodeIds.findIndex((nodeId) => a.id === nodeId) - nextNodeIds.findIndex((nodeId) => b.id === nodeId)\n    })\n  })\n\n  const groupRow = groupBy(extendNodes, (item) => item.row)\n\n  const SPACING = 50\n  const LAYOUT_BASIC_COORDINATE = {\n    LEFT: 100,\n    TOP: 100,\n  }\n\n  const COLUMN_STEP_WIDTH = 200 + SPACING\n  let baseRowTop = LAYOUT_BASIC_COORDINATE.TOP\n\n  Object.values(groupRow).forEach((aRow) => {\n    const groupColum = groupBy(aRow, (item) => item.column)\n    const aRowHeightList = Object.values(groupColum).map((aColumn) => {\n      let currentTop = baseRowTop\n\n      aColumn.forEach((cell) => {\n        cell.coordinates = [(cell.column - 1) * COLUMN_STEP_WIDTH + LAYOUT_BASIC_COORDINATE.LEFT, currentTop]\n        currentTop += cell.style.height + SPACING\n      })\n\n      const columnReduceHeight = aColumn.reduce((pre: number, cur) => cur.style.height + pre + SPACING, 0)\n\n      return columnReduceHeight\n    })\n    const rowMaxHeight = maxBy(aRowHeightList) || 0\n    baseRowTop += rowMaxHeight\n  })\n\n  const newNodes = extendNodes.map((node) => {\n    return {\n      ...omit(node, 'column', 'row', 'style'),\n    }\n  })\n  return { links: links, nodes: newNodes }\n}\n","import React, { useCallback, useState, useRef } from 'react'\nimport { DiagramCanvas } from './DiagramCanvas'\nimport { NodesCanvas } from './NodesCanvas'\nimport { LinksCanvas } from './LinksCanvas'\nimport { Segment } from './Segment'\n\nimport './style.scss'\nimport {\n  IDiagramType,\n  ILinkType,\n  ISegmentType,\n  IPortRefs,\n  INodeRefs,\n  ITransform,\n  ICoordinateType,\n  NodeTypeEnum\n} from '../../types'\nimport { isEqual } from 'lodash-es'\nimport useEventCallback from '../../hooks/useEventCallback'\nimport { batchUpdateCoordinates, calculatingCoordinates, findIndexById, oneNodeDelete } from '../../utils'\nimport { copyNode, createNode } from '../NodeTypes/config'\nimport { MarkLine } from './MarkLine'\nimport { SelectModel } from './SelectModel'\nimport autoLayout from '../../utils/autoLayout'\nimport { EVENT_AUTO_LAYOUT } from '../../utils/eventBus'\nimport useEventBus from '../../hooks/useEventBus'\n\ninterface DiagramProps {\n  value: IDiagramType\n  onChange: (value: IDiagramType, notAddHistory?: boolean) => void\n  onAddHistory: (value: IDiagramType) => void\n  transform: ITransform\n  activeNodeIds: string[]\n  onToggleActiveNodeId: (nodeId: string) => void\n}\n\n\nexport const Diagram: React.FC<DiagramProps> = React.memo((props) => {\n  const {value, onChange, onAddHistory, transform, activeNodeIds, onToggleActiveNodeId} = props\n  const [segment, setSegment] = useState<ISegmentType | undefined>()\n  const [selectModelPosition, setSelectModelPosition] = useState<ICoordinateType>()\n  const {current: portRefs} = useRef<IPortRefs>({}) // 保存所有 Port 的 Dom 节点\n  const {current: nodeRefs} = useRef<INodeRefs>({}) // 保存所有 Node 的 Dom 节点\n  const startPortIdRef = useRef<string>() // 保存所有 Node 的 Dom 节点\n\n  const handleNodePositionChange = useEventCallback((nodeId: string, nextCoordinates: ICoordinateType) => {\n    const nextNodes = batchUpdateCoordinates(nodeId, nextCoordinates, value.nodes, activeNodeIds)\n    onChange({...value, nodes: nextNodes}, true)\n  })\n\n  const handleNodeValueChange = useEventCallback((nodeId: string, nextNodeValue: any) => {\n    const nextNodes = [...value.nodes]\n    const index = findIndexById(nodeId, nextNodes)\n    nextNodes[index] = {...nextNodes[index], data: nextNodeValue}\n    onChange({...value, nodes: nextNodes})\n  })\n\n  const handleAddHistory = useEventCallback((nodeId: string, nextCoordinates: ICoordinateType) => {\n    const nextNodes = batchUpdateCoordinates(nodeId, nextCoordinates, value.nodes, activeNodeIds)\n    onAddHistory({...value, nodes: nextNodes})\n  })\n\n  const handleNodeCopy = useEventCallback((nodeId: string) => {\n    const index = findIndexById(nodeId, value.nodes)\n    const newNode = copyNode(value.nodes[index])\n    onChange({...value, nodes: [...value.nodes, newNode]})\n  })\n\n\n  const handleNodeDelete = useEventCallback((nodeId: string) => {\n    const nextValue = oneNodeDelete(value, nodeId)\n    onChange(nextValue)\n  })\n\n\n  // when a port is registered, save it to the local reference\n  const onPortRegister = useEventCallback((portId: string, portEl: HTMLElement) => {\n    portRefs[portId] = portEl\n  })\n\n  // when a node is registered, save it to the local reference\n  const onNodeRegister = useEventCallback((nodeId: string, nodeEl: HTMLDivElement) => {\n    // const rect = nodeEl.getBoundingClientRect()\n    nodeRefs[nodeId] = nodeEl\n  })\n\n  // when a new segment is dragged, save it to the local state\n  const onDragNewSegment = useCallback((portId, from, to) => {\n    setSegment({id: `segment-${portId}`, from, to})\n  }, [])\n\n  // when a segment fails to connect, reset the segment state\n  const onSegmentFail = useCallback(() => {\n    setSegment(undefined)\n  }, [])\n\n  const onShowSelectModel = useEventCallback((event: MouseEvent, input: string) => {\n    startPortIdRef.current = input\n    setSelectModelPosition([event.clientX, event.clientY])\n    setSegment(undefined)\n  })\n\n  // when a segment connects, update the links schema, perform the onChange callback\n  // with the new data, then reset the segment state\n  const onSegmentConnect = useEventCallback((input: string, output: string) => {\n    const linkIsExists = value.links.findIndex((link) => link.input === input && link.output === output) > -1\n    if (!linkIsExists) {\n      const nextLinks = [...value.links, {input, output}]\n\n      onChange({...value, links: nextLinks})\n    }\n    setSegment(undefined)\n  })\n\n  // when links change, performs the onChange callback with the new incoming data\n  const onLinkDelete = useEventCallback((link: ILinkType) => {\n    const nextLinks = value.links.filter((item) => !isEqual(item, link))\n    onChange({...value, links: nextLinks})\n  })\n\n  const handleSelectModelChange = useEventCallback((nodeType?: NodeTypeEnum) => {\n    if (nodeType && selectModelPosition) {\n      const coordinates: ICoordinateType = calculatingCoordinates(\n        {clientX: selectModelPosition[0], clientY: selectModelPosition[1]} as MouseEvent,\n        document.getElementById('diagram-canvas'),\n        transform.scale\n      )\n      const newNode = createNode(nodeType, coordinates)\n      onChange({...value, nodes: [...value.nodes, newNode]})\n      // nodes 更新后 渲染 link\n      setTimeout(() => {\n        onSegmentConnect(startPortIdRef.current || '', newNode.id)\n      }, 20)\n    }\n    setSelectModelPosition(undefined)\n  })\n\n  const handleAutoLayout = useCallback(() => {\n    const resultValue = autoLayout(value, nodeRefs)\n    onChange(resultValue)\n  }, [value, nodeRefs, onChange])\n\n  useEventBus({type: EVENT_AUTO_LAYOUT, onChange: handleAutoLayout})\n\n  return (\n    <DiagramCanvas portRefs={portRefs} nodeRefs={nodeRefs} transform={transform}>\n      <NodesCanvas\n        nodes={value.nodes}\n        onNodeMount={onNodeRegister}\n        onPortMount={onPortRegister}\n        onDragNewSegment={onDragNewSegment}\n        onSegmentFail={onSegmentFail}\n        onShowSelectModel={onShowSelectModel}\n        onNodePositionChange={handleNodePositionChange}\n        onNodeValueChange={handleNodeValueChange}\n        onNodeDelete={handleNodeDelete}\n        onNodeCopy={handleNodeCopy}\n        onSegmentConnect={onSegmentConnect}\n        onAddHistory={handleAddHistory}\n        onToggleActiveNodeId={onToggleActiveNodeId}\n        activeNodeIds={activeNodeIds}\n      />\n      {value.links.length > 0 && <LinksCanvas nodes={value.nodes} links={value.links} onDelete={onLinkDelete}/>}\n      {segment && <Segment segment={segment}/>}\n      <MarkLine onNodePositionChange={handleNodePositionChange}/>\n      <SelectModel position={selectModelPosition} onChange={handleSelectModelChange}/>\n    </DiagramCanvas>\n  )\n})\n\nDiagram.displayName = 'Diagram'\n","import { useReducer, useCallback } from 'react'\nimport { IDiagramType } from '../types'\n\n// 初始化useReducer中的state\nconst initialState = {\n  // 当我们每次添加新state时，用来储存更新前状态的数组\n  past: [],\n  // 当前的state值\n  present: null,\n  // 让我们可以用使用重做功能的，future数组\n  future: [],\n}\n\n// 根据action处理state的改变\nconst reducer = (state: any, action: any) => {\n  const { past, present, future } = state\n  const { newPresent } = action\n\n  switch (action.type) {\n    case 'UNDO':\n      const previous = past[past.length - 1]\n      const newPast = past.slice(0, past.length - 1)\n\n      return {\n        past: newPast,\n        present: previous,\n        future: [present, ...future],\n      }\n    case 'REDO':\n      const next = future[0]\n      const newFuture = future.slice(1)\n\n      return {\n        past: [...past, present],\n        present: next,\n        future: newFuture,\n      }\n    case 'SET':\n      return {\n        past: [...past],\n        present: newPresent,\n        future: [],\n      }\n\n    case 'SET_WIDTH_HISTORY':\n      if (newPresent === present) {\n        return state\n      }\n      return {\n        past: [...past, present],\n        present: newPresent,\n        future: [],\n      }\n\n    case 'ADD_A_HISTORY':\n      if (newPresent === present) {\n        return state\n      }\n      return {\n        past: [...past, newPresent],\n        present: present,\n        future: [],\n      }\n\n    case 'CLEAR':\n      const { initialPresent } = action\n\n      return {\n        ...initialState,\n        present: initialPresent,\n      }\n  }\n}\n\n// Hook\nexport const useHistory = (initialPresent: IDiagramType) => {\n  const [state, dispatch] = useReducer(reducer, {\n    ...initialState,\n    present: initialPresent,\n  })\n\n  const canUndo = state.past.length !== 0\n  const canRedo = state.future.length !== 0\n\n  const undo = useCallback(() => {\n    if (canUndo) {\n      dispatch({ type: 'UNDO' })\n    }\n  }, [canUndo, dispatch])\n\n  const redo = useCallback(() => {\n    if (canRedo) {\n      dispatch({ type: 'REDO' })\n    }\n  }, [canRedo, dispatch])\n\n  // 只设置值 不追加历史记录 例如 移动 node的过程不需要记录\n  const set = useCallback((newPresent) => dispatch({ type: 'SET', newPresent }), [dispatch])\n\n  // 设置值 并且追加历史记录 例如 增加删除节点，修改节点data数据等\n  const setWithHistory = useCallback((newPresent) => dispatch({ type: 'SET_WIDTH_HISTORY', newPresent }), [dispatch])\n\n  // 仅追加一条历史记录不设置值 例如 节点移动后，把节点拖拽的起始位置 追加进入历史栈\n  const addAHistory = useCallback((newPresent) => dispatch({ type: 'ADD_A_HISTORY', newPresent }), [dispatch])\n\n  const clear = useCallback(() => dispatch({ type: 'CLEAR', initialPresent }), [dispatch, initialPresent])\n\n  return { present: state.present, set, setWithHistory, addAHistory, undo, redo, clear, canUndo, canRedo }\n}\n","import React from 'react'\n\nimport './style.scss'\nimport IconClick from '../../static/icon-click.png'\nimport IconMove from '../../static/icon-move.png'\nimport IconWheel from '../../static/icon-wheel.png'\n\nexport interface ShortcutsPanelProps {}\n\nconst isMac = (() => /macintosh|mac os x/i.test(navigator.userAgent))()\n\nconst CTRL_OR_CMD = isMac ? 'CMD' : 'Ctrl'\n// const ALT_OR_OPT = isMac ? 'OPT' : 'Alt'\n\nconst hotkeyList = [\n  { text: '撤销', hotKeys: [{ key: CTRL_OR_CMD }, { key: 'Z' }] },\n  { text: '多选', hotKeys: [{ key: 'Shift' }, { icon: IconClick }] },\n  { text: '重做', hotKeys: [{ key: CTRL_OR_CMD }, { key: 'Shift' }, { key: 'Z' }] },\n  { text: '全选', hotKeys: [{ key: CTRL_OR_CMD }, { key: 'A' }] },\n  { text: '复制', hotKeys: [{ key: CTRL_OR_CMD }, { key: 'C' }] },\n  { text: '缩放', hotKeys: [{ icon: IconWheel }] },\n  { text: '粘贴', hotKeys: [{ key: CTRL_OR_CMD }, { key: 'V' }] },\n  { text: '移动画布', hotKeys: [{ key: 'Space' }, { icon: IconMove }] },\n  { text: '删除', hotKeys: [{ key: 'Del' }] },\n  // { text: '自动排列', hotKeys: [{ key: CTRL_OR_CMD }, { key: 'Shift' }, { key: 'A' }] },\n]\n\nexport const ShortcutsPanel: React.FC<ShortcutsPanelProps> = React.memo(({}) => {\n  return (\n    <ul className=\"shortcuts-panel\">\n      {hotkeyList.map((item, index) => (\n        <li key={index} className=\"shortcuts-panel-item\">\n          <div className=\"shortcuts-panel-title\">{item.text} :</div>\n          <div className=\"shortcuts-panel-list\">\n            {item.hotKeys.map((keyItem, keyIndex) => (\n              <React.Fragment key={keyIndex}>\n                {keyIndex > 0 && <span className=\"shortcuts-panel-plus\">+</span>}\n                <div className=\"shortcuts-panel-key\">\n                  {keyItem.key}\n                  {keyItem.icon && <img className=\"shortcuts-panel-icon\" src={keyItem.icon} alt={item.text} />}\n                </div>\n              </React.Fragment>\n            ))}\n          </div>\n        </li>\n      ))}\n    </ul>\n  )\n})\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAE8ElEQVRoQ+2ZbWibVRTH/+c+6YugTKjMTVaoTBRBcFBRHCpVvw3FJmkc7sv8IO1sm3RTaZNqWdyHPunswCVrXQu6itjh0jRxU/ZpWFEYsk0niqK2UFDsVrYxcYy+5LlHbmpqDGlznydFWmy/tfe8/H/3nHse7i1hjf9QKfobAqHzyn8kaj5USpxSfIsC+Hw+Ix6PW4WSrHoAd0voGSHYOzd7reXU4ODNfIhVDeALh8v56kwKRBsl0zfzs1fa8iFWNYDa7fo9wRqjjAaIUCUZ56/9ObV3bGhoJluJVQ+QD8GSzonL5W3xeHhOra0JgByIo0S4QzKPjcYiry01Odx7Oh8QLmxj4hoibGCGC8zXSdAkW/SdMf3Lt0sNBSfTqOgUygZ9rvn16jIXH5YkzdHDkXO5ydSkkpu2Pg/gBSK6azkhDFwH4yNhVRyP94dvOBGd66MNoJwKjVR3c/v9hss4AODuQmKYuR+SbzCJGiKuI6KNyo4ZVyRgJmPm56VA2ALIT+RuDT4lBHUT4FpKRBrclIpGLmTX3c0djwlD+ImwdQGE+xOxyHtOIQoCZA9nftDcL25GiEv0Lide+ecDZCspN9/TRsCujA3zoVQsctwJhCMAz97OzWTJYSK6rVjSQgBZH28gtJsAPysGi5pH+7q/LhYvf91RC3kCoR4BPK2TbDkA5e8JdB4Q4B0MnhRTEzvtTijbAO6W0L2GgWEd8Uu10L8mWHP4VmnMnFLVTEvZlTrSc1o3trKzDeBtDQVJoEE3SbEKqDje1mAjCWpk4GIiar6kG9sZQCD0KQF36ibRAfD427cIMlIZQemKOjvfB1sV8DV2bOBKcUZXvE4LLR5ofyhJhGrLgj/ZZ57VzWELwO3veNAg8a5ucDsAnkAoKoDtsBAe6TM/0c1hC6A+EKx1gQZ0g9sCaA3uF4KeZSCWiJrv6+ZYhQA8mIhGBtcBCu1AtoXUR4csGtLZJQs4m+wzrxaz9Sy20H9QAQZfSEQjTcVE2VlfB9DZrZwWWq9A/oatt9D/q4UYE4mYuVMHWtdmsYUkm4kjkYSun60v8d8X+A+YcTMRM5/QTaJj520NDpCgWkjZNWLjTmALwLdv3y1sVX6hBFlz8zuSR3undcTp2Hj9wc/UpcYCvZiMdn+v4+P0PvAhAfcx86GEw4t4vrj6l4O1rjIaYNCsmCp/MvvypwNhqwIq4OLtifGruDTeYPcOW0iUxx/sFUR1EjgzGjU7dIRnbWwDuFtCVcKgkwSuWIkq5N4x0vPclHrnnzckHRDbAJkqBEKvqDcddZilZTUl+w/+qJMs32ZhM/gYQT1H0lcj0e4Wu3EcAajDLNOVw+oKmHkilAgk+8yf7STPiBfoVy90aiMY1q7R2MHf7MRwdIizCRb+d4BjanJkKgG87bo0/rHOmaj3tz9skLE/8zjAsCxLvprs7/nSrviSAJSzeiMSgmNEVKV+Z+AnCXnCNYOx+GDPH7mCfL5weXrT7KPE8AqB7Rn7BfCuUh54HbVQrjDVCobAGyA8nvt3Bi4T6HcQWyxxO4irCVSRtWHGDxbSb6Zib0042XnHU2ipZGqWizLaLRiPgGAsZaeEk8QJmh4/rdNuxeBKrkChycKwtgkyagDekulTommL5aSYMy6ODnZPFRNlZ33FAewkXwnbdYCV2MVSYqxXoJTdWwnfNV+BvwALEYtPTIIeoAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAFiUlEQVRoQ+2Zf2hbVRTHzzkvbVNxWFEclQ4L/kJRLEwGGwjCZLAxMT8WpkNh+8N2tEnbqbRJEFfYTLLZuZH0hwuoFXQiaX6IIuyPgsoUNiwIE8fKKsrAlTFBmbq2y7tH7mtfeE1/vNs0td1o/0pz3zvnfO75nnPfO0G4xf/wFo8flAHcgc6nUDj+zPS+/dtqglYCkMETUAIA/mVBTasJwhbADB4R7pA7zwzXVhPEggDultA9SPAmIm9AwHoDAOAiM/yqOcYPp44fv7HScrLNgAxwV0toJ2jQJT/ngZty8djwSgdu+r/9AKTmWfC9ud6jQyalq6Vjq0bUJv8XSOFsPPKTueb1B73M2g8rVdgzMlDoNiySPKkZAJqj8nqqr+tvq2R8jZ136aAZRY1OfgkYtq1UYRcAiruNGTADJ9PxWNIK4PEHDxLh89bv7LqThE4lj/xV7topAOzyh+JAsKXYgSqA0aEEJ9M9saSnMVyLVbqLATchQD0iritsCMM1QDgvQJxx5KuHirO7WMACgO/AgWqhOxMI0MAAP7Lgy0ZQiF9nE9FvrIbdLZ0vIGKDISHCRxDgUcH8KWh0CnVoQ+TnZm8ETiBw1cys8XUAPEVjVR+lUl2Tiw3e8D9D2yaEDrnB3uiX5ppxHlTgA0ZNTFaOWHfN2xpsZIZ1LPAiEXSYB95cmaQrzoGbd/+zQaukzUC0XYJPH46XWFBnKY1gVhuVmchPOjdke6MjZhALnQOu/cF6qIDNDsTXF9rBuaToag5u0xzYhgDrmfm6QApYO5xKRpZ8DrhbQju16UNusQDyepldIu5GxCeNRqDhvsyJyBWV4GdJqPgm9/437kNnZR3qYgsi7p1ax25BMKLhjQs6V9egzp/NJ5sZep+jm5nrRv3lnQOI8CAzn08nYvvKAmAtbKtBWbCZROyYpzV0hAC2qjibS0LW+zzt4VoUMCgLXdehK2upwYXs20qoGKIQfKCjjlDLqQRvFOoCGTBteP3BRiSUTeFSOhF9UcW2LYA0YkIw8wW58/I7byD0KiI0qThRBXDtba9xrKs+DQiarsMeayOZz48SgAHh66q09mpvIPihLLxyAkhbnkCojxA2scAT6Z7Ix3b2lQGKDXkDoW9Vite8T0VCRmZbg40I2CgAv8rEI28tC4DMBtdOfG9nXLULWa8zzxwGHk7HY7YSLSkD8lmHnPzFcgC4WoMbHYAn1wAW2t3bKgOD8ejTi5GS3bX/u4TWAIpSspYBO40ap6Wlja5JaE1CKpopusb6KIHa+DPlnJHu8nduB6JDy3oSTz10hb+TLx/58fzuXPKd0RL2Yc5bvP7wy0jcLgQMZXqinXZ2S3oWmgIIfSKnCjqIQ9n4kc/tHKmuewLBbkJ8lhn70onIB3b3lQ7gD7ch8SuC4VwmEW22c6Sy7mvuulM4xk8jYFX+Jjfl+u2n4CUDuFvDT2jAAzIw1bcnOwjzLY+Z/6Cx0R2pVEq3u6dkAKuM5CSPrlxqUnE4X0ByAkIVFYPyJckcUdoFL9eXBCAHwhrS+9IQA5xKx6PvqjgtvmZ6rHISER5n4N9Jm9it2tmWBDCdhdcQYI8BwTxAY6P9i8mE1L3umDhBAA3AoOdBD+QSR8+pbsSSAXw+n6avfyhCZM6H8CzfFMfS/bFf7IJwt4Q2k8YhBLzfqCWGSDYRzdjdZ11fMoA0ZkDUPnyQgHdMyynPzGcE8xDm9eHse91XTaeeQEcdI24kRpc51WDACaFzVHWYVXYA06B8IWcN2hGgxuqEjd8G+Sri1E7PWGP4WQg4rDIDmiszZcmA1bDRy2nSBcSF8fksxwy6QDjLDOni3x4WI58ldyE7Z3LyDJp4TNOphpGrkHFCJ3HZ4ZgcUe0ydj7KngE7h+Vev+UB/gN5EApeyCXHVgAAAABJRU5ErkJggg==\"","import React, { useCallback } from 'react'\nimport { Button, Popover } from 'antd'\n\nimport './style.scss'\nimport eventBus, { EVENT_AUTO_LAYOUT } from '../../utils/eventBus'\nimport { ShortcutsPanel } from './ShortcutsPanel'\n\nexport interface ToolbarProps {\n  undo: () => void\n  redo: () => void\n  canUndo: boolean\n  canRedo: boolean\n  scale: number\n}\n\nexport const Toolbar: React.FC<ToolbarProps> = React.memo(({ undo, redo, canUndo, canRedo, scale }) => {\n  const handleAutoLayout = useCallback(() => {\n    eventBus.emit(EVENT_AUTO_LAYOUT)\n  }, [])\n\n  return (\n    <div className=\"toolbar\">\n      <Button disabled>{scale * 100}%</Button>\n      <Button disabled={!canUndo} onClick={undo}>\n        撤销\n      </Button>\n      <Button disabled={!canRedo} onClick={redo}>\n        重做\n      </Button>\n      <Popover trigger=\"click\" placement=\"right\" content={<ShortcutsPanel />} overlayClassName=\"scale-popover\">\n        <Button>快捷键</Button>\n      </Popover>\n      <Button onClick={handleAutoLayout}>自动排列</Button>\n    </div>\n  )\n})\n","import React, { useCallback } from 'react'\n\nimport './style.scss'\n\nexport interface NodeListItemProps {\n  icon: React.FC\n  label: string\n  type: string\n}\n\nexport const NodeListItem: React.FC<NodeListItemProps> = React.memo(({ icon, label, type }) => {\n  const handleDragStart = useCallback(\n    (event: any) => {\n      event.dataTransfer?.setData('nodeType', type)\n    },\n    [type]\n  )\n  return (\n    <div className=\"node-list-item\" draggable onDragStart={handleDragStart}>\n      {icon && React.createElement(icon)}\n      <div className=\"node-list-text\">{label}</div>\n    </div>\n  )\n})\n\nNodeListItem.displayName = 'NodeListItem'\n","import React, { memo } from 'react'\nimport './style.scss'\nimport { NodeListItem } from './NodeListItem'\nimport { nodesList } from '../NodeTypes/config'\n\nexport interface NodeListProps {}\n\nexport const NodeList: React.FC<NodeListProps> = memo(() => {\n  return (\n    <div className=\"node-list\">\n      {nodesList.map((node) => (\n        <NodeListItem key={node.type} icon={node.icon} type={node.type} label={node.label} />\n      ))}\n    </div>\n  )\n})\n\nNodeList.displayName = 'NodeList'\n","import { useEffect, useRef } from 'react'\n\nfunction useEventListener(eventName: string, handler: (event?: any) => void, element = document, options?: any) {\n  // 创建一个储存处理方法的ref\n  const savedHandler = useRef<any>()\n\n  // 当处理函数改变的时候更新ref.current的方法\n  // 这样可以使我们的总是获取到最新的处理函数\n  // 并且不需要在它的effect依赖数组中传递\n  // 并且避免有可能每次渲染重新引起effect方法\n  useEffect(() => {\n    savedHandler.current = handler\n  }, [handler])\n\n  useEffect(\n    () => {\n      // 确认是否支持addEventListener\n      const isSupported = element && element.addEventListener\n      if (!isSupported) return\n\n      // 创建一个调用储存在ref中函数的事件监听\n      const eventListener = (event: any) => savedHandler.current(event)\n\n      // 添加事件监听\n      element.addEventListener(eventName, eventListener, options)\n\n      // 在cleanup的回调中，清除事件监听\n      return () => {\n        element.removeEventListener(eventName, eventListener)\n      }\n    },\n    [eventName, element, options] // 当元素或者绑定事件改变时，重新运行\n  )\n}\nexport default useEventListener\n","export const SCALE_STEP = 0.1\n\n\nexport const DRAG_STATE = {\n  DEFAULT: 'DEFAULT',\n  START: 'START',\n  MOVE: 'MOVE',\n  END: 'END',\n  SELECTION: 'SELECTION'\n}\n\nexport const CURSOR_MAP = {\n  [DRAG_STATE.DEFAULT]: 'default',\n  [DRAG_STATE.SELECTION]: 'default',\n  [DRAG_STATE.START]: 'grab',\n  [DRAG_STATE.MOVE]: 'grabbing'\n}\n","import { IDiagramType } from '../types'\n\nexport const defaultValue: IDiagramType = {\n  'links': [{'input': 'port-1', 'output': 'node-2'}, {\n    'input': 'port-5',\n    'output': '841e9704-c295-4915-8ba9-1d8ab4e6b172'\n  }, {\n    'input': 'd0ce404a-d95c-4210-be5d-106cb707ecda',\n    'output': '0d8dcb00-7c54-488a-9e85-0f92cb463cc3'\n  }, {'input': '1751249f-fb2c-44ed-b324-e99cf1d8a5fd', 'output': '1a5f12bc-9d9c-48e2-905d-97e865845e87'}],\n  'nodes': [{\n    'id': 'node-1',\n    'coordinates': [100, 100],\n    'inputs': [],\n    'outputs': [{'id': 'port-1', 'isLinked': true}],\n    'type': 'nodeTypeInput',\n    'data': {'inputValue': 'defaultValue'}\n  }, {\n    'id': '841e9704-c295-4915-8ba9-1d8ab4e6b172',\n    'coordinates': [600, 100],\n    'type': 'nodeTypeInput',\n    'inputs': [],\n    'outputs': [{'id': '62852bf6-4cb8-4437-8cb9-d1edce72de1b', 'isLinked': false}],\n    'data': {'inputValue': 'test'}\n  }, {\n    'id': 'ebac3f07-598e-4e2f-9e81-e67e542322d8',\n    'coordinates': [364, 353],\n    'type': 'nodeTypeButton',\n    'inputs': [],\n    'outputs': [{\n      'id': 'd0ce404a-d95c-4210-be5d-106cb707ecda',\n      'isLinked': false\n    }, {'id': '1751249f-fb2c-44ed-b324-e99cf1d8a5fd', 'isLinked': false}],\n    'data': {\n      'buttonList': [{'text': 'button-1', 'id': 'd0ce404a-d95c-4210-be5d-106cb707ecda'}, {\n        'text': 'button-2',\n        'id': '1751249f-fb2c-44ed-b324-e99cf1d8a5fd'\n      }]\n    }\n  }, {\n    'id': '0d8dcb00-7c54-488a-9e85-0f92cb463cc3',\n    'coordinates': [604, 353],\n    'type': 'nodeTypeInput',\n    'inputs': [],\n    'outputs': [{'id': 'f854d9bc-0b0e-481c-acfe-786a20483726', 'isLinked': false}],\n    'data': {'inputValue': 'input'}\n  }, {\n    'id': 'f57ee82a-2f1e-45e8-905a-187d36a45dbb',\n    'coordinates': [100, 370],\n    'type': 'nodeTypeSelect',\n    'inputs': [],\n    'outputs': [{'id': '459c4240-26f7-4351-857d-ba856ca755cb', 'isLinked': false}],\n    'data': {'inputValue': '', 'selectValue': 'lucy'}\n  }, {\n    'id': 'node-2',\n    'type': 'nodeTypeSelect',\n    'coordinates': [367, 226],\n    'inputs': [{'id': 'input-1', 'isLinked': false}],\n    'outputs': [{'id': 'port-5', 'isLinked': false}],\n    'data': {'selectValue': ''}\n  }, {\n    'id': '1a5f12bc-9d9c-48e2-905d-97e865845e87',\n    'coordinates': [597, 478],\n    'type': 'nodeTypeSelect',\n    'inputs': [],\n    'outputs': [{'id': '2d16159f-3f1c-4370-b3fc-28bd8e51c388', 'isLinked': false}],\n    'data': {'inputValue': ''}\n  }]\n}\n\n\nconst manyNode: any = new Array(500).fill({}).map((item, index) => {\n  return {\n    id: 'node-' + index,\n    coordinates: [index * 40 + 200, index * 50],\n    inputs: [],\n    outputs: [{id: 'port-' + index, isLinked: false}],\n    type: 'nodeTypeInput',\n    data: {\n      inputValue: 'defaultValue'\n    }\n  }\n})\n\nconst manyLink = new Array(400).fill({}).map((item, index) => {\n  return {input: 'port-' + index, output: 'node-' + (index + 1)}\n})\n\nexport const bigDataValue = {\n  nodes: manyNode,\n  links: manyLink\n}\n","import React, { useCallback, useMemo, useRef, useState, memo } from 'react'\nimport { Diagram } from './components/Diagram'\nimport { useHistory } from './hooks/useHistory'\nimport { Toolbar } from './components/Toolbar/Toolbar'\nimport { NodeList } from './components/NodeList/NodeList'\nimport { IDiagramType, ICoordinateType, IMousePosition, ITransform, ISelectionArea, INodeType } from './types'\nimport { copyNode, createNode } from './components/NodeTypes/config'\nimport { throttle } from 'lodash-es'\nimport {\n  calculatingCoordinates,\n  checkIsFocusInPanel,\n  checkMouseDownTargetIsDrawPanel,\n  collideCheck,\n  oneNodeDelete\n} from './utils'\nimport { useHotkeys } from 'react-hotkeys-hook'\nimport useEventCallback from './hooks/useEventCallback'\nimport useEventListener from './hooks/useEventListener'\nimport {\n  HOT_KEY_COPY,\n  HOT_KEY_DEL, HOT_KEY_PASTE,\n  HOT_KEY_REDO,\n  HOT_KEY_SELECT_ALL,\n  HOT_KEY_SPACE,\n  HOT_KEY_UNDO\n} from './constant/hotKeys'\nimport { CURSOR_MAP, DRAG_STATE, SCALE_STEP } from './constant'\nimport { defaultValue } from './utils/creatMockData'\n// import { useThrottleFn } from 'react-use'\n\n\n\n\nfunction DiagramPanel() {\n  const {\n    present,\n    set,\n    setWithHistory,\n    addAHistory,\n    undo: handleUndo,\n    redo: handleRedo,\n    canUndo,\n    canRedo\n  } = useHistory(defaultValue)\n\n  const value = present as IDiagramType\n  const [transform, setTransform] = useState<ITransform>({\n    scale: 1,\n    translateX: 0,\n    translateY: 0\n  })\n  const [selectionArea, setSelectionArea] = useState<ISelectionArea | undefined>()\n  const [dragState, setDragState] = useState<string>(DRAG_STATE.DEFAULT)\n  const mouseDownStartPosition = useRef<IMousePosition | undefined>()\n  const [activeNodeIds, setActiveNodeIds] = useState<string[]>([])\n\n  const panelRef = useRef<HTMLDivElement>(null)\n  const selectionAreaRef = useRef<HTMLDivElement>(null)\n  const batchCopyNodesRef = useRef<INodeType[]>([])\n  const batchCopyActiveNodeIdsRef = useRef<string[]>([])\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const panelRect = useMemo(() => panelRef.current?.getBoundingClientRect() || {x: 0, y: 0}, [panelRef.current])\n\n  // eslint-disable-next-line\n  const handleThrottleSetTransform = useCallback(\n    throttle((transform) => {\n      setTransform(transform)\n    }, 20),\n    [setTransform]\n  )\n\n  const handleChange = useCallback(\n    (newValue: IDiagramType, notAddHistory?: boolean) => {\n      if (notAddHistory) {\n        set(newValue)\n      } else {\n        setWithHistory(newValue)\n      }\n    },\n    [set, setWithHistory]\n  )\n\n  const handleAddHistory = useCallback(\n    (newValue: IDiagramType) => {\n      addAHistory(newValue)\n    },\n    [addAHistory]\n  )\n\n  const handleDrop = useCallback(\n    (event: any) => {\n      if (event) {\n        event = window.event\n      }\n      const nodeType = event.dataTransfer.getData('nodeType')\n\n      const coordinates: ICoordinateType = calculatingCoordinates(\n        event,\n        document.getElementById('diagram-canvas'),\n        transform.scale\n      )\n\n      const newNode = createNode(nodeType, coordinates)\n      handleChange({...value, nodes: [...value.nodes, newNode]})\n    },\n    [handleChange, transform, value]\n  )\n\n  const handleDrag = useCallback((e: any) => {\n    e.preventDefault()\n  }, [])\n\n  const handleWheel = useEventCallback((event: any) => {\n    if (!panelRef.current?.contains(event.target)) return\n\n    const wheelDelta = event.wheelDelta\n\n    let {scale, translateX, translateY} = transform\n\n    const offsetX = ((event.clientX - panelRect.x - translateX) * SCALE_STEP) / scale\n    const offsetY = ((event.clientY - panelRect.y - translateY) * SCALE_STEP) / scale\n\n    if (wheelDelta < 0) {\n      scale = scale - SCALE_STEP\n      translateX = translateX + offsetX\n      translateY = translateY + offsetY\n    }\n    if (wheelDelta > 0) {\n      scale = scale + SCALE_STEP\n      translateX = translateX - offsetX\n      translateY = translateY - offsetY\n    }\n\n    if (scale > 1 || scale < 0.1) return\n\n    handleThrottleSetTransform({\n      scale: Number(scale.toFixed(2)),\n      translateX,\n      translateY\n    })\n  })\n\n  const handleMouseDown = useEventCallback((event) => {\n    mouseDownStartPosition.current = {\n      x: event.clientX,\n      y: event.clientY,\n      relativeX: event.clientX - transform.translateX,\n      relativeY: event.clientY - transform.translateY\n    }\n    if (checkMouseDownTargetIsDrawPanel(event, panelRef.current)) {\n      if (dragState === DRAG_STATE.START) {\n        setDragState(DRAG_STATE.MOVE)\n      } else {\n        setDragState(DRAG_STATE.SELECTION)\n        setActiveNodeIds([])\n      }\n    }\n  })\n\n  // eslint-disable-next-line\n  const handleThrottleSetSelectionArea = useCallback(\n    throttle((e) => {\n      if (mouseDownStartPosition.current && panelRef.current) {\n        // const panelRect = panelRef.current.getBoundingClientRect()\n        setSelectionArea({\n          left: Math.min(e.clientX, mouseDownStartPosition.current.x) - panelRect.x,\n          top: Math.min(e.clientY, mouseDownStartPosition.current.y) - panelRect.y,\n          width: Math.abs(e.clientX - mouseDownStartPosition.current.x),\n          height: Math.abs(e.clientY - mouseDownStartPosition.current.y)\n        })\n        const selectAreaDom = selectionAreaRef.current\n        const activeNodeIds = value.nodes\n          .map((v) => v.id)\n          .filter((id) => {\n            return collideCheck(selectAreaDom, document.getElementById(id))\n          })\n\n        setActiveNodeIds(activeNodeIds)\n      }\n    }, 20),\n    [transform, value]\n  )\n\n  const handleMouseUp = useEventCallback((event) => {\n    if (dragState === DRAG_STATE.MOVE) {\n      setDragState(DRAG_STATE.START)\n    } else {\n      setDragState(DRAG_STATE.DEFAULT)\n    }\n    setSelectionArea(undefined)\n    mouseDownStartPosition.current = undefined\n  })\n\n  const handleMouseMove = useEventCallback((event) => {\n    if (dragState === DRAG_STATE.MOVE && mouseDownStartPosition.current) {\n      handleThrottleSetTransform({\n        ...transform,\n        translateX: event.clientX - mouseDownStartPosition.current.relativeX,\n        translateY: event.clientY - mouseDownStartPosition.current.relativeY\n      })\n    }\n\n    if (dragState === DRAG_STATE.SELECTION) {\n      handleThrottleSetSelectionArea(event)\n    }\n  })\n\n  const handleSpaceHotKey = useEventCallback((event: KeyboardEvent) => {\n    if (event.type === 'keydown' && dragState === DRAG_STATE.DEFAULT) {\n      setDragState(DRAG_STATE.START)\n    }\n    if (event.type === 'keyup') {\n      setDragState(DRAG_STATE.DEFAULT)\n    }\n  })\n\n  const handleSelectAll = useEventCallback((event: KeyboardEvent) => {\n    if (checkIsFocusInPanel(panelRef.current)) {\n      event.preventDefault()\n      setActiveNodeIds(value.nodes.map((node) => node.id))\n    }\n  })\n\n  const handleBatchDelete = useEventCallback(() => {\n    if (checkIsFocusInPanel(panelRef.current) && activeNodeIds.length) {\n      let nextValue = {...value}\n      activeNodeIds.forEach(nodeId => {\n        nextValue = oneNodeDelete(nextValue, nodeId)\n      })\n      handleChange(nextValue)\n    }\n  })\n\n  const handleBatchCopy = useEventCallback((event: KeyboardEvent) => {\n    if (checkIsFocusInPanel(panelRef.current) && activeNodeIds.length) {\n      event.preventDefault()\n      batchCopyNodesRef.current = value.nodes\n      batchCopyActiveNodeIdsRef.current = activeNodeIds\n    }\n  })\n\n  const handleBatchPaste = useEventCallback((event: KeyboardEvent) => {\n    if (checkIsFocusInPanel(panelRef.current)) {\n      event.preventDefault()\n      const nextValue = batchCopyActiveNodeIdsRef.current.map((nodeId: string) => {\n        const nodeIndex = batchCopyNodesRef.current.findIndex(node => node.id === nodeId)\n        return copyNode(batchCopyNodesRef.current[nodeIndex])\n      })\n      handleChange({...value, nodes: [...value.nodes, ...nextValue]})\n    }\n  })\n\n  const handleToggleActiveNodeId = useEventCallback((nodeId: string) => {\n    let nextActiveNodeIds = [...activeNodeIds]\n    const findIndex = nextActiveNodeIds.findIndex(activeNodeId => activeNodeId === nodeId)\n    if (findIndex > -1) {\n      nextActiveNodeIds.splice(findIndex, 1)\n    } else {\n      nextActiveNodeIds = [...nextActiveNodeIds, nodeId]\n    }\n    setActiveNodeIds(nextActiveNodeIds)\n  })\n\n  const cursor = useMemo(() => {\n    return CURSOR_MAP[dragState]\n  }, [dragState])\n\n  const hideSelectionArea = useMemo(() => dragState !== DRAG_STATE.SELECTION, [dragState])\n\n  const selectionAreaStyled = useMemo(\n    () => ({\n      left: selectionArea?.left,\n      top: selectionArea?.top,\n      width: selectionArea?.width,\n      height: selectionArea?.height\n    }),\n    [selectionArea]\n  )\n\n  /*\n   * bind some hotkeys\n   */\n  useHotkeys(HOT_KEY_UNDO, handleUndo, {}, [handleUndo])\n  useHotkeys(HOT_KEY_REDO, handleRedo, {}, [handleRedo])\n  useHotkeys(HOT_KEY_COPY, handleBatchCopy, {}, [handleBatchCopy])\n  useHotkeys(HOT_KEY_PASTE, handleBatchPaste, {}, [handleBatchPaste])\n  useHotkeys(HOT_KEY_SELECT_ALL, handleSelectAll, {}, [handleSelectAll])\n  useHotkeys(HOT_KEY_DEL, handleBatchDelete, {}, [handleBatchDelete])\n  useHotkeys(HOT_KEY_SPACE, handleSpaceHotKey, {keyup: true, keydown: true}, [handleSpaceHotKey])\n\n  useEventListener('wheel', handleWheel)\n\n  useEventListener('mouseup', handleMouseUp)\n  useEventListener('mousemove', handleMouseMove)\n  useEventListener('mousedown', handleMouseDown)\n\n  return (\n    <>\n      <div\n        id=\"diagram-panel\"\n        ref={panelRef}\n        className=\"diagram-panel\"\n        onDrop={handleDrop}\n        onDragEnter={handleDrag}\n        onDragOver={handleDrag}\n        tabIndex={1}\n        style={{cursor}}\n      >\n        <Diagram\n          value={value}\n          transform={transform}\n          onChange={handleChange}\n          onAddHistory={handleAddHistory}\n          activeNodeIds={activeNodeIds}\n          onToggleActiveNodeId={handleToggleActiveNodeId}\n        />\n        <div\n          ref={selectionAreaRef}\n          className=\"diagram-selection-area\"\n          hidden={hideSelectionArea}\n          style={selectionAreaStyled}\n        />\n      </div>\n      <Toolbar undo={handleUndo} redo={handleRedo} canUndo={canUndo} scale={transform.scale} canRedo={canRedo}/>\n      <NodeList/>\n    </>\n  )\n}\n\nexport default memo(DiagramPanel)\n","export const HOT_KEY_COPY = 'ctrl+c, cmd+c'\nexport const HOT_KEY_PASTE = 'ctrl+v, cmd+v'\nexport const HOT_KEY_UNDO = 'ctrl+z, cmd+z'\nexport const HOT_KEY_REDO = 'ctrl+shift+z, cmd+shift+z'\nexport const HOT_KEY_SELECT_ALL = 'ctrl+a, cmd+a'\nexport const HOT_KEY_DEL = 'del'\nexport const HOT_KEY_AUTO_LAYOUT = 'ctrl+shift+a, cmd+shift+a'\nexport const HOT_KEY_SPACE = 'space'\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport DiagramPanel from './DiagramPanel'\nimport reportWebVitals from './reportWebVitals'\n// import { Test } from './testComponent/Test'\n\nReactDOM.render(\n  <React.StrictMode>\n    <DiagramPanel />\n    {/* <Test /> */}\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}